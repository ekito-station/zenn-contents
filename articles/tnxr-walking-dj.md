---
title: "Walking DJ é–‹ç™ºè¨˜éŒ²ï¼ˆTOKYO NODE OPEN LAB 2024 â€œXR PARADEâ€ï¼‰"
emoji: "ğŸ’¿"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["unity", "csharp", "api", "ios", "javascript"]
published: true
---
# ã¯ã˜ã‚ã«
2024å¹´10æœˆã«è™ãƒé–€ãƒ’ãƒ«ã‚ºã§é–‹å‚¬ã•ã‚ŒãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€Œ[TOKYO NODE OPEN LAB 2024 â€œXR PARADEâ€ created with TNXR](https://www.tokyonode.jp/lab/events/openlab2024_xr_parade/index.html)ã€ã«ã¦ã€éŸ³æ¥½ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰ARã‚¢ãƒ—ãƒªã€ŒWalking DJã€ã‚’é–‹ç™ºãƒ»å±•ç¤ºã—ã¾ã—ãŸã€‚æœ¬è¨˜äº‹ã§ã¯ã€ã“ã®ã‚¢ãƒ—ãƒªã®é–‹ç™ºéç¨‹ã‚’ã¾ã¨ã‚ãŸã„ã¨æ€ã„ã¾ã™ã€‚ç‰¹ã«ã€Unityã¨Spotify APIã®é€£æºã«ã¤ã„ã¦è©³ã—ã‚ã«è¨˜éŒ²ã™ã‚‹ã®ã§ã€Unityã§Spotify APIã‚’æ´»ç”¨ã—ãŸã„äººã®å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚

## Walking DJ æ¦‚è¦
ã€ŒWalking DJã€ã¯ã€ãƒ¦ãƒ¼ã‚µã‚™ãƒ¼ã‹ã‚™è¡—ã‚’æ­©ã„ã¦ã„ã‚‹ã¨ãã®å ´æ‰€ã«åˆã£ãŸæ¥½æ›²ã‚’ãƒ¬ã‚³ãƒ¡ãƒ³ãƒˆã‚™ã—ã¦ãã‚Œã‚‹ARã‚¢ãƒ•ã‚šãƒªã§ã™ã€‚ã€Œâ€œXR PARADEâ€ created with TNXRã€ã§å±•ç¤ºã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã€è™ãƒé–€ãƒ’ãƒ«ã‚ºãƒ»ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ãƒ¯ãƒ¼ãƒ»B2Fã‚¢ãƒˆãƒªã‚¦ãƒ å†…ã«ãŠã‘ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å ´æ‰€ã«åŸºã¥ã„ã¦æ¥½æ›²ã‚’ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰ã—ã¾ã™ã€‚

https://x.com/tokyonodelab/status/1843899202935644619

ä½¿ç”¨ã—ãŸãƒ„ãƒ¼ãƒ«ã¯ä¸»ã«ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ã€‚

- Unity
- [Spotify API](https://developer.spotify.com/documentation/web-api)
- [Immersal](https://immersal.com/)
- [unity-webview](https://github.com/gree/unity-webview)


### Walking DJ ãƒ‡ãƒ¢å‹•ç”»
https://www.youtube.com/watch?v=wLX4vHpueWQ

## ãƒ—ãƒ­ã‚°ãƒ©ãƒ æ¦‚è¦
### TOKYO NODE OPEN LAB 2024
è™ãƒé–€ãƒ’ãƒ«ã‚ºã«æ‹ ç‚¹ã‚’æŒã¤éƒ½å¸‚ä½“é¨“ã®ç ”ç©¶é–‹ç™ºãƒãƒ¼ãƒ ã€Œ[TOKYO NODE LAB](https://www.tokyonode.jp/lab/)ã€ã®é–‹è¨­1å‘¨å¹´ã‚’è¨˜å¿µã—ã¦é–‹å‚¬ã•ã‚ŒãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã™ã€‚è™ãƒé–€ãƒ’ãƒ«ã‚ºãƒ»ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ãƒ¯ãƒ¼ã®å„æ‰€ã«ã¦ã€å±•ç¤ºã‚„ãƒˆãƒ¼ã‚¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ãªã©ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒå±•é–‹ã•ã‚Œã¾ã—ãŸã€‚
#### TOKYO NODE OPEN LAB 2024 ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ
https://tokyonode.jp/lab/events/openlab2024/index.html
### â€œXR PARADEâ€ created with TNXR
TOKYO NODE OPEN LAB 2024ã®ä¸€ç’°ã¨ã—ã¦ã€è™ãƒé–€ãƒ’ãƒ«ã‚ºãƒ»ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ãƒ¯ãƒ¼ã®B2Fã‚¢ãƒˆãƒªã‚¦ãƒ ã«ã¦é–‹å‚¬ã•ã‚ŒãŸå±•ç¤ºä¼šã§ã™ã€‚2024å¹´2æœˆã«é–‹å‚¬ã•ã‚ŒãŸãƒãƒƒã‚«ã‚½ãƒ³ã€Œ[TOKYO NODE â€œXR HACKATHONâ€ powered by PLATEAU](https://tokyonode.jp/sp/xrhackathon2023)ã€ã®å‚åŠ è€…ã‚’ä¸­å¿ƒã«çµæˆã•ã‚ŒãŸéƒ½å¸‚XRå®Ÿè£…ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã€ŒTNXRã€ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒã€è™ãƒé–€ã®è¡—ã‚’èˆå°ã¨ã—ãŸXRã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å±•ç¤ºã—ã¾ã—ãŸã€‚
#### â€œXR PARADEâ€ created with TNXR ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ
https://www.tokyonode.jp/lab/events/openlab2024_xr_parade/index.html

# ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“
Walking DJã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæµã‚Œã«ãªã£ã¦ã„ã¾ã™ã€‚

#### 0. ã‚¹ãƒãƒ›ã®ã‚«ãƒ¡ãƒ©ã§å‘¨å›²ã®æ™¯è‰²ã‚’æ˜ ã—ã¦ã€ç©ºé–“ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹
ã‚¢ãƒ—ãƒªèµ·å‹•ç›´å¾Œã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½ç½®ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã«ã‚¹ãƒãƒ›ã®ã‚«ãƒ¡ãƒ©ã§å‘¨å›²ã®æ™¯è‰²ã‚’è¦‹æ¸¡ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆç‰¹å®šã¾ã§æ•°ç§’ã‹ã‚‰åç§’ã»ã©ã‹ã‹ã‚Šã¾ã™ï¼‰ã€‚
![](/images/tnxr-walking-dj/user_flow_0.jpg)
*ãƒ‡ãƒ¢å‹•ç”»ã‚ˆã‚ŠæŠœç²‹ï¼ˆå·¦å´ã®ç”»åƒã¯å®Ÿéš›ã®ã‚¢ãƒ—ãƒªç”»é¢ï¼‰*
#### 1. ã‚¹ã‚­ãƒ£ãƒ³ãŒå®Œäº†ã™ã‚‹ã¨ã€ã‚¢ãƒˆãƒªã‚¦ãƒ å†…ã«ãŠã‘ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ãŒè¨ˆæ¸¬ã•ã‚Œå§‹ã‚ã‚‹
ã‚¢ãƒˆãƒªã‚¦ãƒ å†…ã«XYå¹³é¢ã‚’è¨­å®šã—ã€ãã®ä¸Šã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã‚’è¨ˆç®—ã—ã¾ã™ã€‚Xè»¸ã¯Energyï¼ˆæ¥½æ›²ã®ã‚¨ãƒãƒ«ã‚®ãƒƒã‚·ãƒ¥ã•ï¼‰ã€Yè»¸ã¯Danceabilityï¼ˆæ¥½æ›²ã®è¸Šã‚Šã‚„ã™ã•ï¼‰ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚Xè»¸æ–¹å‘ã§ã¯ã‚«ãƒ•ã‚§ã‹ã‚‰ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚¿ãƒ¼ã«è¿‘ã¥ãã»ã©Energyã®å€¤ãŒé«˜ããªã‚Šã€Yè»¸æ–¹å‘ã§ã¯é§…ã‹ã‚‰ãƒ¢ãƒ¼ãƒ«ã«è¿‘ã¥ãã»ã©Danceabilityã®å€¤ãŒé«˜ããªã‚Šã¾ã™ã€‚
![](/images/tnxr-walking-dj/map.png)
*ã‚¢ãƒˆãƒªã‚¦ãƒ ã«ãŠã‘ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã¨éŸ³æ¥½ç‰¹æ€§ã®å¯¾å¿œã‚¤ãƒ¡ãƒ¼ã‚¸*
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã¯ã‚¢ãƒ—ãƒªç”»é¢ã®ä¸Šç«¯ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
![](/images/tnxr-walking-dj/user_flow_1.jpg)
*ãƒ‡ãƒ¢å‹•ç”»ã‚ˆã‚ŠæŠœç²‹ï¼ˆå·¦å´ã®ç”»åƒã¯å®Ÿéš›ã®ã‚¢ãƒ—ãƒªç”»é¢ï¼‰*
#### 2. Select Trackãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ãã®æ™‚ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã«åŸºã¥ã„ã¦æ›²ãŒé¸ã°ã‚Œã‚‹
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã«å¯¾å¿œã™ã‚‹éŸ³æ¥½ç‰¹æ€§ï¼ˆEnergy, Danceabilityï¼‰ã®å€¤ã«æœ€ã‚‚è¿‘ã„æ¥½æ›²ãŒã‚»ãƒ¬ã‚¯ãƒˆã•ã‚Œã¾ã™ã€‚ã‚»ãƒ¬ã‚¯ãƒˆã•ã‚ŒãŸæ¥½æ›²ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚„ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆåã€ãã—ã¦ã‚¸ãƒ£ã‚±ãƒƒãƒˆã¯ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
![](/images/tnxr-walking-dj/user_flow_2.jpg)
*ãƒ‡ãƒ¢å‹•ç”»ã‚ˆã‚ŠæŠœç²‹ï¼ˆå·¦å´ã®ç”»åƒã¯å®Ÿéš›ã®ã‚¢ãƒ—ãƒªç”»é¢ï¼‰*
#### 3. Play Trackãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€é¸ã°ã‚ŒãŸæ›²ãŒå†ç”Ÿã•ã‚Œã‚‹
![](/images/tnxr-walking-dj/user_flow_3.jpg)
*ãƒ‡ãƒ¢å‹•ç”»ã‚ˆã‚ŠæŠœç²‹ï¼ˆå·¦å´ã®ç”»åƒã¯å®Ÿéš›ã®ã‚¢ãƒ—ãƒªç”»é¢ï¼‰*
Stop Trackãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€æ¥½æ›²ã®å†ç”Ÿã¯æ­¢ã¾ã‚Šã¾ã™ã€‚
#### 4. é¸ã°ã‚ŒãŸæ›²ã¯ã€ŒARãƒ¬ã‚³ãƒ¼ãƒ‰ã€ã¨ã—ã¦ãã®å ´ã«ç½®ã‹ã‚Œã‚‹
Select Trackãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸéš›ã«ã€é¸ã°ã‚ŒãŸæ¥½æ›²ã®æƒ…å ±ãŒä¿å­˜ã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰å‹ã®3Dã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆä»¥ä¸‹ã€ã€ŒARãƒ¬ã‚³ãƒ¼ãƒ‰ã€ï¼‰ãŒç›®ã®å‰ã«é…ç½®ã•ã‚Œã¾ã™ã€‚ã“ã®ARãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨ã€ä¿å­˜ã•ã‚Œã¦ã„ã‚‹æ¥½æ›²ã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œå†ç”Ÿã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚
![](/images/tnxr-walking-dj/user_flow_4.jpg)
*ãƒ‡ãƒ¢å‹•ç”»ã‚ˆã‚ŠæŠœç²‹ï¼ˆå·¦å´ã®ç”»åƒã¯å®Ÿéš›ã®ã‚¢ãƒ—ãƒªç”»é¢ï¼‰*


# ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ
ä»¥ä¸Šã®ã‚ˆã†ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€ã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®æµã‚Œã§å‹•ä½œã—ã¦ã„ã¾ã™ã€‚

A. Spotify APIã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—
B. VPSã‚’ä½¿ã£ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã‚’å–å¾—
C. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã«åŸºã¥ã„ã¦Spotify APIã‹ã‚‰æ¥½æ›²æƒ…å ±ã‚’å–å¾—ã—è¡¨ç¤º
D. unity-webiviewã‚’ä½¿ã£ã¦æ¥½æ›²ã‚’å†ç”Ÿ
E. æ¥½æ›²ã®æƒ…å ±ã‚’ç´ã¥ã‘ãŸ3Dã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆARãƒ¬ã‚³ãƒ¼ãƒ‰ï¼‰ã‚’ARç©ºé–“ã«é…ç½®

ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ï¼ˆã“ã†ã„ã†æ›¸ãæ–¹ã§è‰¯ã„ã®ã‹ã‚ã‹ã‚Šã¾ã›ã‚“ãŒï¼‰ã€‚
![](/images/tnxr-walking-dj/system_config.png)
*Walking DJ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³*

ä»¥ä¸‹ã®ç« ã§ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã®å„ã‚¹ãƒ†ãƒƒãƒ—ã®è©³ç´°ã‚’èª¬æ˜ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚
èª¬æ˜ã®ãŸã‚ã«ä¸€éƒ¨ã€å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å¤‰æ›´ãƒ»ç°¡ç•¥åŒ–ã—ã¦ã„ã‚‹ç®‡æ‰€ãŒã‚ã‚Šã¾ã™ã€‚

# A. Spotify APIã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—
æœ¬ã‚¢ãƒ—ãƒªã§ã¯ã€æ¥½æ›²æƒ…å ±ã®å–å¾—ã‚„å†ç”Ÿã«Spotify APIã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
ãã®ãŸã‚ã€ã¾ãšSpotify APIã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ã¾ã™ã€‚ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®å–å¾—ã¯ä»¥ä¸‹ã®2ã¤ã®æ–¹æ³•ã§è¡Œã„ã¾ã™ã€‚

- [Authorization Code Flow](https://developer.spotify.com/documentation/web-api/tutorials/code-flow)ï¼ˆæ¥½æ›²ã®å†ç”Ÿå‘ã‘ã€ãƒ­ã‚°ã‚¤ãƒ³å¿…è¦ï¼‰
- [Client Credentials Flow](https://developer.spotify.com/documentation/web-api/tutorials/client-credentials-flow)ï¼ˆæ¥½æ›²æƒ…å ±ã®å–å¾—å‘ã‘ã€ãƒ­ã‚°ã‚¤ãƒ³ä¸è¦ï¼‰

1ã¤ç›®ã®Authorization Code Flowã¯æ¥½æ›²æƒ…å ±ã®å–å¾—ã¨å†ç”Ÿã®ä¸¡æ–¹ã«å¯¾å¿œã—ã¦ã„ã¾ã™ãŒã€Spotifyã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¸ã®ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚ã“ã®æ–¹æ³•ã®ã¿ã‚’ä½¿ç”¨ã—ãŸå ´åˆã€ãƒ­ã‚°ã‚¤ãƒ³ã§ããªããªã‚‹ã¨ã™ã¹ã¦ã®æ©Ÿèƒ½ãŒä½¿ãˆãªããªã‚‹æã‚ŒãŒã‚ã‚Šã¾ã™ã€‚
2ã¤ç›®ã®Client Credentials Flowã¯æ¥½æ›²æƒ…å ±ã®å–å¾—ã®ã¿å¯èƒ½ã§æ¥½æ›²ã®å†ç”Ÿã«ã¯å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ãŒã€Spotifyã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“ã€‚
ãã®ãŸã‚ã€ãƒˆãƒ©ãƒ–ãƒ«ã«å‚™ãˆã¦2ã¤ã®æ–¹æ³•ã‚’ä½µç”¨ã—ã¦ã„ã¾ã™ã€‚

![](/images/tnxr-walking-dj/access_token_flow.png)
*ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ã®æµã‚Œ*

## Authorization Code Flow
Authorization Code Flowã§ã¯ã€ä»¥ä¸‹ã®æµã‚Œã§ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ã¾ã™ã€‚

1. ã‚¢ãƒ—ãƒªã‹ã‚‰å¤–éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ã‚’èµ·å‹•ã—Spotifyã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‚’é–‹ã
2. ãƒ­ã‚°ã‚¤ãƒ³ã«æˆåŠŸã—ãŸã‚‰Spotify Web APIã«èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’è¦æ±‚ã™ã‚‹
3. èªè¨¼ã‚³ãƒ¼ãƒ‰ãŒè¿”ã£ã¦ããŸã‚‰ã‚¢ãƒ—ãƒªã‚’å†åº¦é–‹ã
4. iOSãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ç”¨ã„ã¦èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’å—ã‘å–ã‚‹
5. èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’ç”¨ã„ã¦Spotify Web APIã«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¦æ±‚ã™ã‚‹
6. APIã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å—ã‘å–ã‚‹

https://developer.spotify.com/documentation/web-api/tutorials/code-flow

#### 1. ã‚¢ãƒ—ãƒªã‹ã‚‰å¤–éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ã‚’èµ·å‹•ã—Spotifyã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‚’é–‹ã

ã‚ã‚‰ã‹ã˜ã‚[Spotify for Developersã‚µã‚¤ãƒˆ](https://developer.spotify.com/)ã®Dashboardã§ã€ã‚¢ãƒ—ãƒªã®Client IDã‚’å–å¾—ã—Redirect URIï¼ˆä¾‹: `myapp://callback/`ï¼‰ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

https://developer.spotify.com/documentation/web-api/tutorials/getting-started#create-an-app

Client IDã‚„Redirect URIãªã©ã‹ã‚‰èªè¨¼ç”¨URLã‚’ä½œæˆã—ã€ãã®URLã‚’å¤–éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãã¾ã™ã€‚

```csharp:SpotifyManager
string clientId = ""; // Client IDã‚’Dashboardã‹ã‚‰å–å¾—
string redirectUri = ""; // Redirect URIã‚’Dashboardã§è¨­å®š
string authEndpoint = "https://accounts.spotify.com/authorize";
// æ¥½æ›²å†ç”Ÿã«å¿…è¦ãªã‚¹ã‚³ãƒ¼ãƒ—ã‚’æŒ‡å®š
string scopes = "user-modify-playback-state  user-read-playback-state user-read-currently-playing streaming";
// èªè¨¼ç”¨URLã‚’ä½œæˆ
string authUrl = $"{authEndpoint}?response_type=code&client_id={_clientId}&redirect_uri={UnityWebRequest.EscapeURL(redirectUri)}&scope={UnityWebRequest.EscapeURL(scopes)}";
// èªè¨¼ç”¨URLã‚’å¤–éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã
Application.OpenURL(authUrl);
```

#### 2. ãƒ­ã‚°ã‚¤ãƒ³ã«æˆåŠŸã—ãŸã‚‰Spotify Web APIã«èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’è¦æ±‚ã™ã‚‹

å¤–éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆSafariãªã©ï¼‰ã§é–‹ã‹ã‚ŒãŸSpotifyã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ãŠã„ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ã«æˆåŠŸã—ãŸã‚‰ã€Spotify Web APIã«èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’è¦æ±‚ã™ã‚‹å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ï¼ˆãŸã ã—ã€æ¥½æ›²ã‚’å†ç”Ÿã™ã‚‹ãŸã‚ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹ã«ã¯ã€Premiumã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ï¼‰

![](/images/tnxr-walking-dj/login_page.jpg =200x)
*Spotifyã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸*

:::message
ã‚¢ãƒ—ãƒªãŒdevelopment modeã ã£ãŸãŸã‚ã€ã‚ã‚‰ã‹ã˜ã‚Spotify for Developersã‚µã‚¤ãƒˆã®Dashboardã®User Managementã§ã€ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®Emailã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç™»éŒ²ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚ã“ã“ã«ç™»éŒ²ã—ã¦ã„ãªã„ã¨ã€ãƒ­ã‚°ã‚¤ãƒ³ã«æˆåŠŸã—ã¦ã‚‚ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ãŒå–å¾—ã§ãã¾ã›ã‚“ã€‚
![](/images/tnxr-walking-dj/user_management.png)
*Dashboardã®User Management*
:::

#### 3. èªè¨¼ã‚³ãƒ¼ãƒ‰ãŒè¿”ã£ã¦ããŸã‚‰ã‚¢ãƒ—ãƒªã‚’å†åº¦é–‹ã

Spotify Web APIã‹ã‚‰èªè¨¼ã‚³ãƒ¼ãƒ‰ãŒè¿”ã£ã¦ããŸã‚‰ã€ä»¥å‰è¨­å®šã—ãŸRedirect URIã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã¾ã™ã€‚ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚ŒãŸéš›ã«ã‚¢ãƒ—ãƒªãŒå†åº¦é–‹ãã‚ˆã†ã«ã€URL Schemeã‚’è¨­å®šã—ã¾ã™ã€‚Unityã®`Project Settings > Player > Other Settings > Supported URL schemes`ã«ã€Redirect URIã®ã‚¹ã‚­ãƒ¼ãƒ ï¼ˆä¾‹: `myapp`ï¼‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

![](/images/tnxr-walking-dj/custom_url_scheme.png)
*URL Schemeã®è¨­å®š*

ã“ã®è¨­å®šã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ­ã‚°ã‚¤ãƒ³å¾Œã‚¢ãƒ—ãƒªã«æˆ»ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

![](/images/tnxr-walking-dj/return_to_app.jpg =200x)
*ã‚¢ãƒ—ãƒªã«æˆ»ã‚‹*

#### 4. iOSãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ç”¨ã„ã¦èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’å—ã‘å–ã‚‹

ã¾ãŸã€ã‚¢ãƒ—ãƒªã«æˆ»ã£ãŸéš›ã«Spotify Web APIã‹ã‚‰è¿”ã£ã¦ãã‚‹URLã‚’ã‚¢ãƒ—ãƒªã«å—ã‘æ¸¡ã™iOSãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã®URLã«èªè¨¼ã‚³ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

:::details iOSãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®å†…å®¹
```objc:UrlHandlerAppController
#import "UnityAppController.h"

// Unityã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹é–¢æ•°ã‚’å®£è¨€
void UnitySendMessage(const char* obj, const char* method, const char* msg);

// UnityAppControllerã‚’æ‹¡å¼µã™ã‚‹ã‚¯ãƒ©ã‚¹ã®å®£è¨€
@interface UrlHandlerAppController : UnityAppController
@end

// UrlHandlerAppControllerã‚¯ãƒ©ã‚¹ã®å®Ÿè£…
@implementation UrlHandlerAppController
// openURLãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url options:(NSDictionary<UIApplicationOpenURLOptionsKey, id> *)options {
    // URLã‚’Cæ–‡å­—åˆ—ã«å¤‰æ›
    const char *urlString = [[url absoluteString] cStringUsingEncoding:NSUTF8StringEncoding];
    // å¤‰æ›ã•ã‚ŒãŸURLã‚’SpotifyManagerã«é€ä¿¡
    UnitySendMessage("SpotifyManager", "HandleUrl", urlString);
    return YES;
}
@end

// UnityAppControllerã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã¨ã—ã¦ç™»éŒ²
IMPL_APP_CONTROLLER_SUBCLASS(UrlHandlerAppController)
```
:::

#### 5. èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’ç”¨ã„ã¦Spotify Web APIã«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¦æ±‚ã™ã‚‹

ã‚¢ãƒ—ãƒªã«å—ã‘æ¸¡ã•ã‚ŒãŸURLã‹ã‚‰èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’æŠ½å‡ºã—ã¾ã™ã€‚
```csharp:SpotifyManager
// iOSãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‹ã‚‰å‘¼ã³å‡ºã•ã‚Œã‚‹é–¢æ•°
public void HandleUrl(string url)
{
    // URLã‹ã‚‰èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’æŠ½å‡º
    string code = GetCodeFromUrl(url);
    // èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’ç”¨ã„ã¦ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¦æ±‚
    StartCoroutine(ExchangeCodeForToken(code));
}
private string GetCodeFromUrl(string url)
{
    var queryParams = System.Web.HttpUtility.ParseQueryString(new System.Uri(url).Query);
    return queryParams["code"];
}
```

æŠ½å‡ºã•ã‚ŒãŸèªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’ç”¨ã„ã¦ã€Spotify Web APIã«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¦æ±‚ã—ã¾ã™ã€‚ã“ã®ã¨ã[Unity Web Request](https://docs.unity3d.com/ScriptReference/Networking.UnityWebRequest.html)ã‚’ä½¿ã„ã¾ã™ã€‚
:::details Unity Web Requestã‚’ä½¿ã£ã¦ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¦æ±‚ã™ã‚‹å‡¦ç†ã®å†…å®¹
```csharp:SpotifyManager
private string clientId = ""; // Client IDã‚’Dashboardã‹ã‚‰å–å¾—
private string clientSecret = ""; // Client Secretã‚’Dashboardã‹ã‚‰å–å¾—
private string tokenEndpoint = "https://accounts.spotify.com/api/token";

private IEnumerator ExchangeCodeForToken(string code)
{
    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æº–å‚™
    UnityWebRequest request = new UnityWebRequest(tokenEndpoint, "POST");
    var form = new WWWForm();
    form.AddField("grant_type", "authorization_code");
    form.AddField("code", code);
    form.AddField("redirect_uri", redirectUri);
    form.AddField("client_id", clientId);
    form.AddField("client_secret", clientSecret);
    request.uploadHandler = new UploadHandlerRaw(form.data);
    request.downloadHandler = new DownloadHandlerBuffer();
    request.SetRequestHeader("Content-Type", "application/x-www-form-urlencoded");

    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡
    yield return request.SendWebRequest();

    if (request.result == UnityWebRequest.Result.Success)
    {
        // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®å–å¾—ã«æˆåŠŸã—ãŸå ´åˆã®å‡¦ç†
        // å¾Œè¿°
    }
    else
    {
        // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®å–å¾—ã«å¤±æ•—ã—ãŸå ´åˆã®å‡¦ç†
        Debug.LogError("Error: " + request.error);
    }
}
```
:::

#### 6. APIã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å—ã‘å–ã‚‹

Spotify Web APIã‹ã‚‰JSONå½¢å¼ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ã‘å–ã‚Šã€ãã‚Œã‚’å¤‰æ›ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–ã‚Šå‡ºã—ã¾ã™ã€‚

:::details ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å—ã‘å–ã‚‹å‡¦ç†ã®å†…å®¹
```csharp:SpotifyManager
private string accessTokenForPlay;
private DateTime tokenForPlayExpiryTime;
private string refreshTokenForPlay;

private IEnumerator ExchangeCodeForToken(string code)
{
    // å‰ç•¥
    if (request.result == UnityWebRequest.Result.Success)
    {
        // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®å–å¾—ã«æˆåŠŸã—ãŸå ´åˆã®å‡¦ç†
        string responseText = request.downloadHandler.text;
        // JSONã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–ã‚Šå‡ºã™
        var responseJson = JsonUtility.FromJson<TokenResponseForPlay>(responseText);
        accessTokenForPlay = responseJson.access_token; // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³
        tokenForPlayExpiryTime = DateTime.Now.AddSeconds(responseJson.expires_in); // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™
        refreshTokenForPlay = responseJson.refresh_token; // ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³
    }
}

// APIã‹ã‚‰å—ã‘å–ã£ãŸJSONå½¢å¼ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¤‰æ›ã™ã‚‹ãŸã‚ã®ã‚¯ãƒ©ã‚¹
[System.Serializable]
public class TokenResponseForPlay
{
    public string access_token;
    public string token_type;
    public int expires_in;
    public string refresh_token;
}
```
:::

## Client Credentials Flow

Client Credentials Flowã§ã¯ã€Spotifyã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’å—ã‘å–ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ãŒã„ã‚‰ãªã„ã®ã§ã€Unity Web Requestã‚’ä½¿ã£ã¦ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¦æ±‚ã—ã¦å—ã‘å–ã‚‹å‡¦ç†ã§æ¸ˆã¿ã¾ã™ã€‚

https://developer.spotify.com/documentation/web-api/tutorials/client-credentials-flow

:::details ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¦æ±‚ã—ã¦å—ã‘å–ã‚‹å‡¦ç†ã®å†…å®¹
```csharp:SpotifyManager
private string accessToken;
private DateTime tokenExpiryTime;

private IEnumerator RequestClientCredentialsToken()
{
    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æº–å‚™
    string url = "https://accounts.spotify.com/api/token";
    WWWForm form = new WWWForm();
    form.AddField("grant_type", "client_credentials");
    UnityWebRequest request = UnityWebRequest.Post(url, form);
    string auth = System.Convert.ToBase64String(System.Text.Encoding.UTF8.GetBytes(clientId + ":" + clientSecret));
    request.SetRequestHeader("Authorization", "Basic " + auth);

    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡
    yield return request.SendWebRequest();

    if (request.result == UnityWebRequest.Result.Success)
    {
        // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®å–å¾—ã«æˆåŠŸã—ãŸå ´åˆã®å‡¦ç†
        var jsonResponse = request.downloadHandler.text;
        // JSONã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–ã‚Šå‡ºã™
        TokenResponse tokenResponse = JsonUtility.FromJson<TokenResponse>(jsonResponse);
        accessToken = tokenResponse.access_token; // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³
        tokenExpiryTime = DateTime.Now.AddSeconds(tokenResponse.expires_in); // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™
    }
    else
    {
        // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®å–å¾—ã«å¤±æ•—ã—ãŸå ´åˆã®å‡¦ç†
        Debug.LogError("Error: " + request.error);
    }
}

// APIã‹ã‚‰å—ã‘å–ã£ãŸJSONå½¢å¼ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¤‰æ›ã™ã‚‹ãŸã‚ã®ã‚¯ãƒ©ã‚¹
[System.Serializable]
public class TokenResponse
{
    public string access_token;
    public string token_type;
    public int expires_in;
}
```
:::

## ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®æ›´æ–°

ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã«ã¯æœ‰åŠ¹æœŸé™ãŒã‚ã‚Šã¾ã™ï¼ˆ1æ™‚é–“ã ã£ãŸã‹ãªï¼‰ã€‚ä»¥å‰å–å¾—ã—ãŸã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚ŒãŸå ´åˆã€æ–°ãŸãªã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
Client Credentials Flowã§å–å¾—ã—ãŸã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚ŒãŸå ´åˆã¯ã€å†åº¦ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¦æ±‚ã™ã‚‹å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚Œã°ã„ã„ã ã‘ã§ã™ã€‚
ãŸã ã€Authorization Code Flowã§å–å¾—ã—ãŸã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚Œã‚‹ãŸã³ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã‚‚ã‚‰ã†ã®ã¯é¢å€’ã§ã™ã€‚ãã“ã§ã€æœ€åˆã«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ãŸéš›ã«åŒæ™‚ã«å–å¾—ã—ãŸãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ã†ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã‚‚ã‚‰ã†å¿…è¦ãªãã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å†å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

:::details ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ã£ã¦ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å†å–å¾—ã™ã‚‹å‡¦ç†ã®å†…å®¹
```csharp:SpotifyManager
private IEnumerator RefreshAccessTokenForPlay()
{
    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æº–å‚™
    string url = "https://accounts.spotify.com/api/token";
    WWWForm form = new WWWForm();
    form.AddField("grant_type", "refresh_token");
    form.AddField("refresh_token", refreshTokenForPlay);
    form.AddField("client_id", clientId);
    form.AddField("client_secret", clientSecret);
    UnityWebRequest request = UnityWebRequest.Post(url, form);

    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡
    yield return request.SendWebRequest();

    if (request.result == UnityWebRequest.Result.Success)
    {
        // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®å†å–å¾—ã«æˆåŠŸã—ãŸå ´åˆã®å‡¦ç†
        var jsonResponse = request.downloadHandler.text;
        // JSONã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–ã‚Šå‡ºã™
        var responseData = JsonUtility.FromJson<RefreshTokenResponse>(jsonResponse);
        accessTokenForPlay = responseData.access_token; // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®æ›´æ–°
        tokenForPlayExpiryTime = DateTime.Now.AddSeconds(responseData.expires_in); // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™ã®æ›´æ–°
    }
    else
    {
        // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®å†å–å¾—ã«å¤±æ•—ã—ãŸå ´åˆã®å‡¦ç†
        Debug.LogError("Error refreshing token: " + request.error);
    }
}

// APIã‹ã‚‰å—ã‘å–ã£ãŸJSONå½¢å¼ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¤‰æ›ã™ã‚‹ãŸã‚ã®ã‚¯ãƒ©ã‚¹
[System.Serializable]
public class RefreshTokenResponse
{
    public string access_token;
    public int expires_in;
}
```
:::

# B. VPSã‚’ä½¿ã£ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã‚’å–å¾—

æ¬¡ã«ã€ã‚¢ãƒˆãƒªã‚¦ãƒ ã«ãŠã‘ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã‚’å–å¾—ã—ã¾ã™ã€‚

![](/images/tnxr-walking-dj/get_position_flow.png)
*ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã‚’å–å¾—ã—ã¦è¡¨ç¤ºã™ã‚‹æµã‚Œ*

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™å–å¾—ã«ã¯ã€éƒ½å¸‚XRå®Ÿè£…ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã€ŒTNXRã€å†…éƒ¨ã§æä¾›ã•ã‚Œã‚‹Toranomon SDKã®VPSæ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ã“ã®VPSæ©Ÿèƒ½ã«ã¯[Immersal](https://immersal.com/)ãŒä½¿ã‚ã‚Œã¦ã„ã¾ã™ã€‚

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ‡ãƒã‚¤ã‚¹ã®ã‚«ãƒ¡ãƒ©ã§å‘¨å›²ã®ç‰©ç†ç©ºé–“ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã€ä¸€åº¦ãƒ­ãƒ¼ã‚«ãƒ©ã‚¤ã‚ºã«æˆåŠŸã™ã‚‹ã¨ARç©ºé–“ã«ã‚°ãƒªãƒƒãƒ‰ã®æã‹ã‚ŒãŸå¹³é¢ãŒé…ç½®ã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã“ã®å¹³é¢ä¸Šã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
ã¾ãŸã€å¹³é¢ãŒé…ç½®ã•ã‚ŒãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ãã®å¹³é¢ã‚’è¤‡è£½ã—ã¦ã€VPSæ©Ÿèƒ½ã‹ã‚‰ã¯ç‹¬ç«‹ã—ã¦é…ç½®ã—ã¦ãŠãã¾ã™ã€‚ã‚‚ã—VPSã®ãƒ­ãƒ¼ã‚«ãƒ©ã‚¤ã‚ºãŒä¸å®‰å®šã«ãªã£ãŸã‚‰å…ƒã®å¹³é¢ã®ä½ç½®ãŒã‚ºãƒ¬ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã‚’æ­£ã—ãè¨ˆç®—ã§ããªããªã‚Šã¾ã™ã€‚ãã®éš›ã¯ã€è¤‡è£½ã•ã‚ŒãŸå¹³é¢ã‚’ä½¿ã£ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã‚’è¨ˆç®—ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

![](/images/tnxr-walking-dj/map.png)
*ã‚¢ãƒˆãƒªã‚¦ãƒ ã«ãŠã‘ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã¨éŸ³æ¥½ç‰¹æ€§ã®å¯¾å¿œã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆå†æ²ï¼‰*

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½ç½®ã«ç›¸å½“ã™ã‚‹`MainCamera`ã®åº§æ¨™ã‚’å®šæœŸçš„ã«å–å¾—ã—ãã‚Œã‚’ã€å¹³é¢ã‚’åŸºæº–ã¨ã—ãŸãƒ­ãƒ¼ã‚«ãƒ«åº§æ¨™ã«å¤‰æ›ã—ã¦ã‹ã‚‰æ­£è¦åŒ–ã—UIã«è¡¨ç¤ºã•ã›ã¾ã™ã€‚æ­£è¦åŒ–ã™ã‚‹ã“ã¨ã§ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«ãŠã„ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã¨æ¥½æ›²ã®éŸ³æ¥½ç‰¹æ€§ï¼ˆEnergy, Danceabilityï¼‰ã‚’å¯¾å¿œã•ã›ã‚„ã™ãã—ã¾ã™ã€‚

:::details ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã‚’å–å¾—ã™ã‚‹å‡¦ç†ã®å†…å®¹
```csharp:PlayerController
public Camera mainCamera; // MainCamera
public GameObject plane; // å¹³é¢
public float planeSizeX; // å¹³é¢ã®å¹…
public float planeSizeZ; // å¹³é¢ã®å¥¥è¡Œã

private Vector2 UpdatePlayerPositionOnPlane()
{    
    // MainCameraã®ãƒ¯ãƒ¼ãƒ«ãƒ‰åº§æ¨™ã‚’å¹³é¢ã®ãƒ­ãƒ¼ã‚«ãƒ«åº§æ¨™ã«å¤‰æ›
    Vector3 localPosition = plane.transform.InverseTransformPoint(mainCamera.transform.position);
    // å¹³é¢ã®ã‚µã‚¤ã‚ºã«åŸºã¥ã„ã¦åº§æ¨™ã‚’æ­£è¦åŒ–
    Vector2 normalizedPosition = new Vector2(
        Mathf.InverseLerp(- planeSizeX / 2, planeSizeX / 2, localPosition.x),
        Mathf.InverseLerp(- planeSizeZ / 2, planeSizeZ / 2, localPosition.z)
    );

    return normalizedPosition;
}
```
:::

# C. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã«åŸºã¥ã„ã¦Spotify APIã‹ã‚‰æ›²ã®æƒ…å ±ã‚’å–å¾—ã—è¡¨ç¤º

Spotify APIã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã®ä¸¡æ–¹ã‚’å–å¾—ã§ããŸã‚‰ã€ç¶šã„ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã«åŸºã¥ã„ã¦Spotify APIã‹ã‚‰æ¥½æ›²ã‚’å–å¾—ã—ã¾ã™ã€‚

![](/images/tnxr-walking-dj/get_song_flow.png)
*ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã«åŸºã¥ã„ã¦æ›²ã®æƒ…å ±ã‚’å–å¾—ã—è¡¨ç¤ºã™ã‚‹æµã‚Œ*

ã“ã“ã§è¡Œã†å‡¦ç†ã¯ã€å¤§ããåˆ†ã‘ã¦ä»¥ä¸‹ã®2ã¤ã§ã™ã€‚

1. ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—å¾Œã«Spotify Web APIã‹ã‚‰æ¥½æ›²ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã¨å„æ¥½æ›²ã®éŸ³æ¥½ç‰¹æ€§ã‚’å–å¾—ã™ã‚‹
2. Select Trackãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸæ™‚ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã¨å„æ¥½æ›²ã®éŸ³æ¥½ç‰¹æ€§ã‚’æ¯”è¼ƒã—æœ€ã‚‚è¿‘ã„æ¥½æ›²ã‚’é¸ã¶

#### 1. ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—å¾Œã«Spotify Web APIã‹ã‚‰æ¥½æ›²ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã¨å„æ¥½æ›²ã®éŸ³æ¥½ç‰¹æ€§ã‚’å–å¾—ã™ã‚‹

ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ãŒå–å¾—ã§ããŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼ˆé€šå¸¸ã¯ã‚¢ãƒ—ãƒªèµ·å‹•ç›´å¾Œï¼‰ã§ã€Spotify Web APIã‹ã‚‰æ¥½æ›²ã®æƒ…å ±ã‚’é›†ã‚ã¾ã™ã€‚
ä»Šå›ã¯ã€ä»¥ä¸‹ã®Spotifyå…¬å¼ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ4ã¤ã‹ã‚‰æ¥½æ›²ã‚’25æ›²ãšã¤ã€è¨ˆ100æ›²ã®æƒ…å ±ã‚’é›†ã‚ã¾ã—ãŸï¼ˆTOKYOã¨ã„ã†åã®ã¤ããƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¾ã—ãŸï¼‰ã€‚

- [Tokyo Super Hits!](https://open.spotify.com/playlist/37i9dQZF1DXafb0IuPwJyF)ï¼ˆæ—¥æœ¬ã®æœ€æ–°ãƒ’ãƒƒãƒˆã‚½ãƒ³ã‚°ç‰¹é›†ï¼‰
- [Tokyo Rising](https://open.spotify.com/playlist/37i9dQZF1DWX9u2doQ8Q2L)ï¼ˆæ—¥æœ¬ã®è‹¥æ‰‹ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆç‰¹é›†ï¼‰
- [Road Trip To Tokyo](https://open.spotify.com/playlist/37i9dQZF1DWV8IND7NkP2W)ï¼ˆã‚¤ãƒ³ã‚¹ãƒˆæ¥½æ›²ç‰¹é›†ï¼‰
- [Tokyo City Pop è¨˜æ†¶ã®è¨˜éŒ²LIBRARY](https://open.spotify.com/playlist/37i9dQZF1DX4CovPIZya4z)ï¼ˆã‚·ãƒ†ã‚£ãƒãƒƒãƒ—ç‰¹é›†ï¼‰

å„ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã«ã¯IDãŒä»˜ä¸ã•ã‚Œã¦ã„ã¦ã€URLã®æœ«å°¾ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ï¼ˆä¾‹: [Tokyo Super Hits!](https://open.spotify.com/playlist/37i9dQZF1DXafb0IuPwJyF)ã®URLã¯`https://open.spotify.com/playlist/37i9dQZF1DXafb0IuPwJyF`ãªã®ã§IDã¯`37i9dQZF1DXafb0IuPwJyF`ï¼‰ã€‚
ã¾ãŸå„æ¥½æ›²ã«ã‚‚IDãŒä»˜ä¸ã•ã‚Œã¦ã„ã¦ã€URLã®æœ«å°¾ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ï¼ˆä¾‹: [æ±äº¬ç ‚æ¼ ](https://open.spotify.com/intl-ja/track/04WsSAv2YHpDA4ft52wcTm)ã®URLã¯`http://open.spotify.com/track/04WsSAv2YHpDA4ft52wcTm`ãªã®ã§IDã¯`04WsSAv2YHpDA4ft52wcTm`ï¼‰ã€‚
Unity Web Requestã‚’ä½¿ã£ã¦ã€å„ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‹ã‚‰ãã“ã«å«ã¾ã‚Œã‚‹æ¥½æ›²ã®IDã‚’å–å¾—ã—ã¦ã€ãã‚Œã‚‰ã®IDã‚’ã¾ã¨ã‚ãŸãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

:::details Spotifyã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‹ã‚‰æ¥½æ›²ã®IDã‚’é›†ã‚ã‚‹å‡¦ç†ã®å†…å®¹
`playlistId`ã¯ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®IDã€`limit`ã¯ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‹ã‚‰å–å¾—ã—ãŸã„æ¥½æ›²ã®æ•°ï¼ˆä»Šå›ã¯25ï¼‰ã€`trackIds`ã¯å–å¾—ã—ãŸæ¥½æ›²ã®IDã‚’è¿½åŠ ã—ã¦ã„ããƒªã‚¹ãƒˆã§ã™ã€‚
```csharp:SpotifyManager
private IEnumerator GetTracksFromPlaylist(string playlistId, int limit, List<string> trackIds)
{
    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æº–å‚™
    string url = $"https://api.spotify.com/v1/playlists/{playlistId}/tracks?limit={limit}";
    UnityWebRequest request = UnityWebRequest.Get(url);
    request.SetRequestHeader("Authorization", "Bearer " + accessToken);

    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡
    yield return request.SendWebRequest();

    if (request.result == UnityWebRequest.Result.Success)
    {
        // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®å–å¾—ã«æˆåŠŸã—ãŸå ´åˆã®å‡¦ç†
        var jsonResponse = request.downloadHandler.text;
        // JSONã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦æ¥½æ›²ã®IDã‚’å–ã‚Šå‡ºã™
        PlaylistTracks playlistTracks = JsonUtility.FromJson<PlaylistTracks>(jsonResponse);
        foreach (var item in playlistTracks.items)
        {
            // å„æ¥½æ›²ã®IDã‚’ãƒªã‚¹ãƒˆã«è¿½åŠ ã™ã‚‹
            trackIds.Add(item.track.id);
        }
    }
    else
    {
        // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®å–å¾—ã«å¤±æ•—ã—ãŸå ´åˆã®å‡¦ç†
        Debug.LogError("Error: " + request.error);
    }
}

// APIã‹ã‚‰å—ã‘å–ã£ãŸJSONå½¢å¼ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¤‰æ›ã™ã‚‹ãŸã‚ã®ã‚¯ãƒ©ã‚¹
[System.Serializable]
public class PlaylistTracks
{
    public PlaylistTrackItem[] items;
}
[System.Serializable]
public class PlaylistTrackItem
{
    public Track track;
}
[System.Serializable]
public class Track
{
    public string id;
    public string name;
    public Artist[] artists;
    public Album album;
}
```
:::

ç¶šã„ã¦ã€å„æ¥½æ›²ã®éŸ³æ¥½ç‰¹æ€§ã‚’å–å¾—ã—ã¾ã™ã€‚Spotifyã¯å„æ¥½æ›²ã®éŸ³æ¥½ç‰¹æ€§ï¼ˆAudio Featuresï¼‰ã‚’æ•°å€¤åŒ–ã—ã¦ã„ã¾ã™ã€‚éŸ³æ¥½ç‰¹æ€§ã«ã¯ã€Walking DJã§ä½¿ç”¨ã—ã¦ã„ã‚‹Energyã‚„Danceabilityã®ã»ã‹ã«ã‚‚Valenceï¼ˆãƒã‚¸ãƒ†ã‚£ãƒ–ã•ï¼‰ãªã©ãŒã‚ã‚Šã€ãã‚Œãã‚Œ0ã‹ã‚‰1ã®é–“ã§æ•°å€¤åŒ–ã•ã‚Œã¦ã„ã¾ã™ï¼ˆä¾‹: [Bling-Bang-Bang-Born](https://open.spotify.com/intl-ja/track/0kdqcbwei4MDWFEX5f33yG)ã®Energyã¯0.822ã€Danceabilityã¯0.853ã€Valenceã¯0.746ï¼‰ã€‚

https://developer.spotify.com/documentation/web-api/reference/get-audio-features

Unity Web Requestã‚’ä½¿ã£ã¦ã€å…ˆã»ã©IDã‚’å–å¾—ã—ãŸæ¥½æ›²ã®éŸ³æ¥½ç‰¹æ€§ã‚’å–å¾—ã—ã¾ã™ã€‚

:::details å„æ¥½æ›²ã®éŸ³æ¥½ç‰¹æ€§ã‚’å–å¾—ã™ã‚‹å‡¦ç†ã®å†…å®¹
```csharp:SpotifyManager
public IEnumerator GetAudioFeatures(List<string> trackIds)
{    
    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æº–å‚™
    string ids = string.Join(",", trackIds);
    string url = $"https://api.spotify.com/v1/audio-features?ids={ids}";
    UnityWebRequest request = UnityWebRequest.Get(url);
    request.SetRequestHeader("Authorization", "Bearer " + accessToken);

    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡
    yield return request.SendWebRequest();

    if (request.result == UnityWebRequest.Result.Success)
    {
        // éŸ³æ¥½ç‰¹æ€§ã®å–å¾—ã«æˆåŠŸã—ãŸå ´åˆã®å‡¦ç†
        var jsonResponse = request.downloadHandler.text;
        // JSONã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦éŸ³æ¥½ç‰¹æ€§ã‚’å–ã‚Šå‡ºã™
        AudioFeaturesResponse audioFeaturesResponse = JsonUtility.FromJson<AudioFeaturesResponse>(jsonResponse);
        List<AudioFeatures> audioFeaturesList = new List<AudioFeatures>(audioFeaturesResponse.audio_features);
    }
    else
    {
        // éŸ³æ¥½ç‰¹æ€§ã®å–å¾—ã«å¤±æ•—ã—ãŸå ´åˆã®å‡¦ç†
        Debug.LogError("Error: " + request.error);
    }
}

// APIã‹ã‚‰å—ã‘å–ã£ãŸJSONå½¢å¼ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¤‰æ›ã™ã‚‹ãŸã‚ã®ã‚¯ãƒ©ã‚¹
[System.Serializable]
public class AudioFeaturesResponse
{
    public AudioFeatures[] audio_features;
}
[System.Serializable]
public class AudioFeatures
{
    public float danceability;
    public float energy;
    public float loudness;
    public float speechiness;
    public float acousticness;
    public float instrumentalness;
    public float liveness;
    public float valence;
    public float tempo;
    public string id;
}
```
:::

#### 2. Select Trackãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸæ™‚ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã¨å„æ¥½æ›²ã®éŸ³æ¥½ç‰¹æ€§ã‚’æ¯”è¼ƒã—æœ€ã‚‚è¿‘ã„æ¥½æ›²ã‚’é¸ã¶

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ãƒ—ãƒªã®Select Trackãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã‚‰ã€ãã®æ™‚ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã¨å…ˆè¿°ã®ã‚¹ãƒ†ãƒƒãƒ—ã§å–å¾—ã—ãŸå„æ¥½æ›²ã®éŸ³æ¥½ç‰¹æ€§ã‚’æ¯”è¼ƒã—ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®Xåº§æ¨™ã¨å„æ¥½æ›²ã®Energyã®å€¤ã®å·®ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®Yåº§æ¨™ã¨å„æ¥½æ›²ã®Danceabilityã®å€¤ã®å·®ã‚’è¨ˆç®—ã—ã€ãã‚Œã‚‰ãŒæœ€ã‚‚å°ã•ã„æ¥½æ›²ã€ã™ãªã‚ã¡ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã¨éŸ³æ¥½ç‰¹æ€§ï¼ˆEnergy, Danceabilityï¼‰ãŒæœ€ã‚‚è¿‘ã„æ¥½æ›²ã‚’ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚

:::details æœ€ã‚‚è¿‘ã„æ¥½æ›²ã‚’é¸ã¶å‡¦ç†ã®å†…å®¹
```csharp:SpotifyManager
private AudioFeatures selectedTrack;
public float distanceThreshold;

public void FindClosestTrack(float userPositionX, float userPositionY)
{
    AudioFeatures closestTrack = null;
    float closestDistance = float.MaxValue;

    foreach (var track in audioFeaturesList)
    {
        float energyDistance = Mathf.Abs(track.energy - userPositionX);
        float danceabilityDistance = Mathf.Abs(track.danceability - userPositionY);
        float distance = energyDistance + danceabilityDistance;
        if (distance < closestDistance)
        {
            closestDistance = distance;
            closestTrack = track;
            if (energyDistance < distanceThreshold && danceabilityDistance < distanceThreshold)
            {
                // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åº§æ¨™ã¨ä¸€å®šæ°´æº–ã‚ˆã‚Šè¿‘ã‹ã£ãŸã‚‰ã€ãã®å¾Œã®æ¥½æ›²ã¨ã®æ¯”è¼ƒã¯ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹
                break;
            }
        }
    }
    selectedTrack = closestTrack;
}
```
:::

é¸ã°ã‚ŒãŸæ¥½æ›²ã®IDã‹ã‚‰ã€Unity Web Requestã‚’ä½¿ã£ã¦ãã®æ¥½æ›²ã®æƒ…å ±ï¼ˆæ›²åã€ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆåã€ã‚¸ãƒ£ã‚±ãƒƒãƒˆç”»åƒï¼‰ã‚’å–å¾—ã—ã¾ã™ã€‚

:::details é¸ã°ã‚ŒãŸæ¥½æ›²ã®æƒ…å ±ã‚’å–å¾—ã™ã‚‹å‡¦ç†ã®å†…å®¹
```csharp:SpotifyManager
public IEnumerator GetTrackInfo(string trackId)
{   
    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æº–å‚™ 
    string url = $"https://api.spotify.com/v1/tracks/{trackId}";
    UnityWebRequest request = UnityWebRequest.Get(url);
    request.SetRequestHeader("Authorization", "Bearer " + accessToken);

    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡
    yield return request.SendWebRequest();

    if (request.result == UnityWebRequest.Result.Success)
    {
        // æ¥½æ›²æƒ…å ±ã®å–å¾—ã«æˆåŠŸã—ãŸå ´åˆã®å‡¦ç†
        var jsonResponse = request.downloadHandler.text;
        // JSONã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦æ¥½æ›²æƒ…å ±ã‚’å–ã‚Šå‡ºã™
        Track track = JsonUtility.FromJson<Track>(jsonResponse);
    }
    else
    {
        // æ¥½æ›²æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ãŸå ´åˆã®å‡¦ç†
        Debug.LogError("Error: " + request.error);
    }
}

// APIã‹ã‚‰å—ã‘å–ã£ãŸJSONå½¢å¼ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¤‰æ›ã™ã‚‹ãŸã‚ã®ã‚¯ãƒ©ã‚¹
[System.Serializable]
public class Track
{
    public string id;
    public string name;
    public Artist[] artists;
    public Album album;
}
[System.Serializable]
public class Artist
{
    public string name;
}
[System.Serializable]
public class Album
{
    public Image[] images;
}
[System.Serializable]
public class Image
{
    public string url;
}
```
:::

ãã—ã¦ã€å–å¾—ã—ãŸæ¥½æ›²ã®æƒ…å ±ã‚’ã‚¢ãƒ—ãƒªç”»é¢ã«è¡¨ç¤ºã—ã¾ã™ã€‚

![](/images/tnxr-walking-dj/display_track_info.jpg =200x)
*é¸ã°ã‚ŒãŸæ¥½æ›²ã®æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã‚¢ãƒ—ãƒªç”»é¢*

# D. unity-webiviewã‚’ä½¿ã£ã¦æ¥½æ›²ã‚’å†ç”Ÿ

æ¥½æ›²ãŒé¸ã°ã‚ŒãŸå¾Œã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒPlay Trackãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã‚‰ãã®æ¥½æ›²ãŒå†ç”Ÿã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

![](/images/tnxr-walking-dj/play_track_flow.png)
*æ¥½æ›²ã‚’å†ç”Ÿã™ã‚‹æµã‚Œ*

å…·ä½“çš„ãªä»•çµ„ã¿ã¨ã—ã¦ã¯ã€[unity-webview](https://github.com/gree/unity-webview)ã‚’ä½¿ã£ã¦ã‚¢ãƒ—ãƒªå†…ã§htmlãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ãã®htmlãƒ•ã‚¡ã‚¤ãƒ«å†…ã§[Spotify Web Playback SDK](https://developer.spotify.com/documentation/web-playback-sdk)ã¨ã„ã†JavaScriptãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦æ¥½æ›²ã‚’å†ç”Ÿã—ã¾ã™ã€‚

:::message
Unityã‚¢ãƒ—ãƒªå†…ã§htmlãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã‘ã‚‹ã‚¢ã‚»ãƒƒãƒˆã¨ã—ã¦[UniWebView](https://docs.uniwebview.com/)ã‚‚ã‚ã‚Šã¾ã™ãŒã€ã“ã¡ã‚‰ã‚’ä½¿ã£ã¦htmlãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ãŸã¨ã“ã‚æ¥½æ›²ã¯å†ç”Ÿã•ã‚Œã¾ã›ã‚“ã§ã—ãŸï¼ˆåŸå› æœªè§£æ˜ï¼‰ã€‚
:::

ã¾ãšã€unity-webviewã‚’ä½¿ã£ã¦Web Viewã‚’å®Ÿè£…ã—ã‚¢ãƒ—ãƒªå†…ã§htmlãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã‘ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

:::details htmlãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãå‡¦ç†ã®å†…å®¹
```csharp:WebViewController
private WebViewObject webViewObject;

public void OpenWebView()
{
    webViewObject = (new GameObject("WebViewObject")).AddComponent<WebViewObject>();
    webViewObject.Init(
        // Webãƒšãƒ¼ã‚¸ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸæ™‚ã®å‡¦ç†
        ld: (msg) =>
        {
            Debug.Log(string.Format("CallOnLoaded[{0}]", msg));
        },
        enableWKWebView: true);
#if UNITY_EDITOR_OSX || UNITY_STANDALONE_OSX
    webViewObject.bitmapRefreshCycle = 1;
#endif
    // webãƒšãƒ¼ã‚¸è‡ªä½“ã¯éè¡¨ç¤ºã«
    webViewObject.SetVisibility(false);
    // ãƒ­ãƒ¼ã‚«ãƒ«ã®htmlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰
    string filePath = System.IO.Path.Combine(Application.streamingAssetsPath, "spotify_player.html");
    webViewObject.LoadURL("file://" + filePath.Replace(" ", "%20"));
}
```
:::

ä»¥ä¸‹ã®ã‚ˆã†ãªhtmlãƒ•ã‚¡ã‚¤ãƒ«ã‚’StreamingAssetsãƒ•ã‚©ãƒ«ãƒ€å†…ã«é…ç½®ã—ã€ã“ã®ãƒ­ãƒ¼ã‚«ãƒ«htmlãƒ•ã‚¡ã‚¤ãƒ«ã‚’Web Viewã§é–‹ãã¾ã™ã€‚é–‹ãã®ã«æ™‚é–“ãŒã‹ã‹ã‚‹ã®ã§ã€å®Ÿéš›ã«ã¯ã‚¢ãƒ—ãƒªã®èµ·å‹•æ™‚ã«é–‹ãã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

::: details æ¥½æ›²ã‚’å†ç”Ÿã™ã‚‹ãŸã‚ã®htmlãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹
```html:spotify_player.html
<!DOCTYPE html>
<html>
    <head>
        <title>Spotify Player</title>
    </head>
    <body>
        <script src="https://sdk.scdn.co/spotify-player.js"></script>
        <script>
            var token = '';
            var trackId = '';
            var player = null;
            
            // console.logã‚’Unityã«é€ä¿¡ã™ã‚‹
            window.console.log = function(...args) {
                const message = args.map(arg => {
                    if (typeof arg === 'object') {
                        try {
                            return JSON.stringify(arg);
                        } catch(e) {
                            return '[Object]';
                        }
                    }
                    return arg;
                }).join(' ');
                Unity.call(message);
            }

            // WebViewControllerã‹ã‚‰tokenã¨trackUriã‚’å—ã‘å–ã‚‹
            function receiveData(newToken, newTrackId) {
                token = newToken;
                trackId = newTrackId;
                console.log('Token: ', token, 'Track Id: ', trackId);
                
                // æ—¢å­˜ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ã€ã¾ãšå‰Šé™¤ã™ã‚‹
                if (player) {
                    console.log('Destroying existing player instance.');
                    player.disconnect();
                    player = null;
                }
                
                // æ–°ã—ã„ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®åˆæœŸåŒ–
                player = new Spotify.Player({
                    name: 'Web Playback SDK Player',
                    getOAuthToken: cb => { cb(token); },
                    volume: 1
                });
                
                // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ ã—ã¦ãƒˆãƒ©ãƒƒã‚¯ã‚’å†ç”Ÿã™ã‚‹
                player.addListener('ready', ({ device_id }) => {
                    console.log('Ready with Device ID', device_id);
                    var trackUri = 'spotify:track:' + trackId;
                    playTrack(device_id, trackUri);
                });

                // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
                player.addListener('not_ready', ({ device_id }) => {
                    console.log('Device ID has gone offline', device_id);
                });

                player.addListener('initialization_error', ({ message }) => {
                    console.error(message);
                });

                player.addListener('authentication_error', ({ message }) => {
                    console.error(message);
                });

                player.addListener('account_error', ({ message }) => {
                    console.error(message);
                });

                player.connect();
            }
            
            window.onSpotifyWebPlaybackSDKReady = () => {
                console.log('Spotify Web Playback SDK is ready');
            };

            // æ¥½æ›²ã‚’å†ç”Ÿã™ã‚‹é–¢æ•°
            function playTrack(deviceId, trackUri) {
                fetch(`https://api.spotify.com/v1/me/player/play?device_id=${deviceId}`, {
                    method: 'PUT',
                    body: JSON.stringify({ uris: [trackUri] }),
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                }).then(response => {
                    if (response.ok) {
                        console.log('Track is playing!');
                    } else {
                        console.error('Error playing track', response.status, response.statusText);
                    }
                }).catch(error => {
                    console.error('Error: ', error);
                });
            }
            
            // æ¥½æ›²ã®å†ç”Ÿã‚’åœæ­¢ã™ã‚‹é–¢æ•°
            function stopTrack() {                
                if (player) {
                    player.pause().then(() => {
                        console.log('Track has been paused.');
                        player.disconnect();
                        player = null;
                    }).catch(error => {
                        console.log('Error pausing track: ', error);
                    });
                } else {
                    console.error('No player instance found.');
                }
            }
        </script>
    </body>
</html>
```
:::

Play Trackãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã‚‰ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆAuthorization Code Flowã§å–å¾—ã•ã‚ŒãŸã»ã†ï¼‰ã¨æ¥½æ›²IDã‚’æ¸¡ã—ã¦ã€htmlãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ¥½æ›²å†ç”Ÿç”¨ã®é–¢æ•°ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚åŒæ§˜ã«ã€Stop Trackãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã‚‰htmlãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ¥½æ›²å†ç”Ÿåœæ­¢ç”¨ã®é–¢æ•°ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```csharp:WebViewController
// Web Viewä¸Šã§æ¥½æ›²ã‚’å†ç”Ÿã™ã‚‹
public void PlayTrackOnWebView(string token, string trackId)
{
    // htmlãƒ•ã‚¡ã‚¤ãƒ«å†…ã®JavaScripté–¢æ•°ã‚’å‘¼ã³å‡ºã™
    webViewObject.EvaluateJS($"receiveData('{token}', '{trackId}');");
}

// Web Viewä¸Šã®æ¥½æ›²ã®å†ç”Ÿã‚’æ­¢ã‚ã‚‹
public void StopTrackOnWebView()
{
    // htmlãƒ•ã‚¡ã‚¤ãƒ«å†…ã®JavaScripté–¢æ•°ã‚’å‘¼ã³å‡ºã™
    webViewObject.EvaluateJS("stopTrack();");
}
```

# E. æ¥½æ›²ã®æƒ…å ±ã‚’ç´ã¥ã‘ãŸ3Dã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆARãƒ¬ã‚³ãƒ¼ãƒ‰ï¼‰ã‚’ARç©ºé–“ã«é…ç½®

Select Trackãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã¨ãã€é¸ã°ã‚ŒãŸæ¥½æ›²ã®æƒ…å ±ã‚’ã‚¢ãƒ—ãƒªç”»é¢ã«è¡¨ç¤ºã™ã‚‹ã¨ã¨ã‚‚ã«ã€ãã®æƒ…å ±ã¨ç´ã¥ã„ãŸãƒ¬ã‚³ãƒ¼ãƒ‰å‹ã®3Dã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆARãƒ¬ã‚³ãƒ¼ãƒ‰ï¼‰ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç›®ã®å‰ã«é…ç½®ã—ã¾ã™ï¼ˆARãƒ¬ã‚³ãƒ¼ãƒ‰ã®ãƒ¢ãƒ‡ãƒ«ã¯Blenderã§åˆ¶ä½œã—ã¾ã—ãŸï¼‰ã€‚

![](/images/tnxr-walking-dj/display_track_info.jpg =200x)
*æ¥½æ›²æƒ…å ±ã®è¡¨ç¤ºã¨ã¨ã‚‚ã«é…ç½®ã•ã‚Œã‚‹ARãƒ¬ã‚³ãƒ¼ãƒ‰*

Select Trackãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚Œã‚‹ãŸã³ã«ãã®å ´ã«ARãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’Instantiateã—ã€ãã®ã¨ãé¸ã°ã‚ŒãŸæ¥½æ›²ã‚’ãã®ARãƒ¬ã‚³ãƒ¼ãƒ‰ã«"æ›¸ãè¾¼ã¿"ã¾ã™ï¼ˆARãƒ¬ã‚³ãƒ¼ãƒ‰ã«ã‚¢ã‚¿ãƒƒãƒã—ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã«æ¥½æ›²ã®IDã‚’æ¸¡ã—ã¾ã™ï¼‰ã€‚
ä»¥å‰é…ç½®ã•ã‚ŒãŸARãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨ã€ãã“ã«æ›¸ãè¾¼ã¾ã‚Œã¦ã„ã‚‹æ¥½æ›²ã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã‚‹ä»•çµ„ã¿ã«ãªã£ã¦ã„ã¾ã™ï¼ˆARãƒ¬ã‚³ãƒ¼ãƒ‰ã«ã‚¢ã‚¿ãƒƒãƒã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‹ã‚‰æ¥½æ›²ã®IDã‚’å–ã‚Šå‡ºã—ã€å…ˆè¿°ã®ä»•çµ„ã¿ã¨åŒæ§˜ã«ã—ã¦Unity Web Requestã‚’ä½¿ã£ã¦ãã®æ¥½æ›²ã®æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ï¼‰ã€‚
Play Trackãƒœã‚¿ãƒ³ã‚’æŠ¼ã›ã°å…ˆè¿°ã®ä»•çµ„ã¿ã§ã€è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹æ¥½æ›²ãŒå†ç”Ÿã•ã‚Œã¾ã™ã€‚

# UIãƒ‡ã‚¶ã‚¤ãƒ³

æœ€å¾Œã«UIãƒ‡ã‚¶ã‚¤ãƒ³é¢ã§å·¥å¤«ã—ãŸç‚¹ã‚’ã„ãã¤ã‹è¨˜éŒ²ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

### ãƒ˜ãƒ«ãƒ—ç”»é¢

ã‚¢ãƒ—ãƒªã®å³ä¸‹ã«å¸¸æ™‚è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã€Œï¼Ÿã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ãƒ˜ãƒ«ãƒ—ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
â¶ã«ãŠã‘ã‚‹ã‚°ãƒªãƒƒãƒ‰ä¸Šã®é»’ã„ç‚¹ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãã®ã¨ãå®Ÿéš›ã«ã„ã‚‹åº§æ¨™ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€â·ã¨â¸ã®ãƒœã‚¿ãƒ³ã‚„â¹ã®ARãƒ¬ã‚³ãƒ¼ãƒ‰ã¯ã‚¿ãƒƒãƒ—ã§ãã¾ã™ã€‚
Canvasä¸Šã§ARãƒ¬ã‚³ãƒ¼ãƒ‰ã®3Dã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¡¨ç¤ºã•ã›ã‚‹ãŸã‚ã«ã€[RenderTexture](https://docs.unity3d.com/ScriptReference/RenderTexture.html)ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

![](/images/tnxr-walking-dj/help.jpg =200x)
*ãƒ˜ãƒ«ãƒ—ç”»é¢*

https://youtu.be/xX6Log7jtRs

### UIã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

ä»¥ä¸‹ã®UIã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«[DOTween](https://assetstore.unity.com/packages/tools/animation/dotween-hotween-v2-27676)ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

#### 1. ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«ã‚¹ãƒãƒ›ã‚’å‹•ã‹ã—ã¦ç©ºé–“ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ã‚ˆã†æŒ‡ç¤ºã™ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

ã‚¢ãƒ—ãƒªèµ·å‹•ç›´å¾Œã«ç”»é¢å³ä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚¹ãƒãƒ›ã‚¢ã‚¤ã‚³ãƒ³ã«ã¯ã€`DOLocalPath`ã§ãƒ‘ã‚¹ã‚’ä½¿ã£ãŸæ›²ç·šã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã—ã¦ã„ã¾ã™ã€‚

https://youtu.be/nw43Pi4Upx8

#### 2. æ¥½æ›²å†ç”Ÿæ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

æ¥½æ›²å†ç”Ÿæ™‚ã«ã‚¸ãƒ£ã‚±ãƒƒãƒˆç”»åƒã®ä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹æ°´ç‰ã‚¢ã‚¤ã‚³ãƒ³ã«ã¯ã€`DOScale`ãªã©ã§ç¾ã‚ŒãŸã‚Šæ¶ˆãˆãŸã‚Šã™ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã—ã¦ã„ã¾ã™ã€‚

https://youtu.be/qNxhklf2TS0

### ARãƒ¬ã‚³ãƒ¼ãƒ‰ 

ä½“é¨“ã—ã¦ã„ãŸã ã„ãŸæ–¹ã‹ã‚‰ã€ã€ŒARãƒ¬ã‚³ãƒ¼ãƒ‰ãŒä½•ã‚’æ„å‘³ã™ã‚‹ã®ã‹åˆè¦‹ã§ã¯ã‚ã‹ã‚‰ãªã‹ã£ãŸã€ã¨ã„ã†å£°ã‚’ã„ãŸã ãã€æ”¹å–„ã®ä½™åœ°ãŒã‚ã‚‹ã¨æ„Ÿã˜ã¾ã—ãŸã€‚
ä¸€æ–¹ã§ã€ã€Œã·ã‹ã·ã‹æµ®ã‹ã‚“ã§ã„ãŸã‹ã‚‰è‡ªç„¶ã¨ã‚¿ãƒƒãƒ—ã—ãŸããªã£ãŸã€ã¨ã„ã†å£°ã‚‚ã„ãŸã ãã€ãã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã¦è‰¯ã‹ã£ãŸã¨æ€ã„ã¾ã—ãŸã€‚

ã¾ãŸã€ã‚¿ãƒƒãƒ—ã•ã‚ŒãŸARãƒ¬ã‚³ãƒ¼ãƒ‰ã«ã¯ç·‘è‰²ã®è¼ªã‚’ã¤ã‘ã‚‹ã“ã¨ã§ã€ç¾åœ¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹æ¥½æ›²ãŒã©ã®ARãƒ¬ã‚³ãƒ¼ãƒ‰ã«ç´ã¥ã„ã¦ã„ã‚‹ã®ã‹è¦–è¦šçš„ã«ã‚ã‹ã‚Šã‚„ã™ããªã‚‹ã‚ˆã†å·¥å¤«ã—ã¾ã—ãŸã€‚ã•ã‚‰ã«æ¥½æ›²å†ç”Ÿæ™‚ã«ã¯ã€Particle Systemã‚’ä½¿ã£ã¦ARãƒ¬ã‚³ãƒ¼ãƒ‰ã‹ã‚‰éŸ³ç¬¦ãŒæ¹§ãå‡ºã™ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

https://youtu.be/8ir5xJRdct4

# ãŠã‚ã‚Šã«

ä»¥ä¸Šã€Walking DJã®é–‹ç™ºéç¨‹ã«ã¤ã„ã¦ã¾ã¨ã‚ã¾ã—ãŸã€‚
ä¼ç”»ã‹ã‚‰é–‹ç™ºã¾ã§ä¸€äººã§è¡Œã£ãŸã‚ŠUnityã¨Web APIã®é€£æºè‡ªä½“ãŒåˆã‚ã¦ã ã£ãŸã‚Šã‹ãªã‚Šãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°ã§ã—ãŸãŒã€å±•ç¤ºæœŸé–“ä¸­ã‚¢ãƒ—ãƒªã¯ç„¡äº‹ã«å‹•ã„ã¦ã„ãŸã‚ˆã†ãªã®ã§ãƒ›ãƒƒã¨ã—ã¦ã„ã¾ã™ã€‚

æµ·å¤–ã‹ã‚‰ä¼ç”»æ›¸ã‚’ä½œã£ãŸã‚Šã‚¢ãƒ—ãƒªã‚’é–‹ç™ºã—ãŸã‚Šã—ã¦ã„ãŸãªã‹ã€TNXRã®ãƒ¡ãƒ³ãƒãƒ¼ã®æ–¹ã€…ã‚„ç¾åœ°ãƒ†ã‚¹ãƒˆã®æ‰‹ä¼ã„ã‚’ã—ã¦ã„ãŸã ã„ãŸ[ryu](https://x.com/arukana0813)ã•ã‚“ãªã©å¤šãã®äººã«ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãŸã ãã¾ã—ãŸã€‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼

https://x.com/tokyonodelab/status/1843821354438799413

https://x.com/tokyonodelab/status/1854513160520397255
