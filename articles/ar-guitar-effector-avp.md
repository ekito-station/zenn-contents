---
title: "ARã‚®ã‚¿ãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ã‚¿ãƒ¼ Apple Vision Pro ver."
emoji: "ğŸ¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [ar, swift, applevisionpro, visionos, realitycomposerpro]
published: true
---
# 1 ã¯ã˜ã‚ã«

ã“ã®è¨˜äº‹ã¯ã€2025å¹´3æœˆ1æ—¥ã«æ±äº¬ãƒãƒ¼ãƒˆã‚·ãƒ†ã‚£ç«¹èŠã§é–‹å‚¬ã•ã‚ŒãŸã€Œ[ç¬¬16å›VRãƒ•ã‚§ã‚¹](https://peatix.com/event/4292335?lang=ja-jp)ã€ã«ã¦å±•ç¤ºã—ãŸã€"AR Guitar Effectorã€Apple Vision Pro ver.ã€‘"ã®é–‹ç™ºè¨˜éŒ²ã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚

https://youtu.be/IuJFRhzgsK8

## 1.1 AR Guitar Effector (ARã‚®ã‚¿ãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ã‚¿ãƒ¼) ã¨ã¯

ã€ŒAR Guitar Effectorã€ã¯ã€ARæŠ€è¡“ã‚’æ´»ç”¨ã—ãŸæ–°ã—ã„ã‚®ã‚¿ãƒ¼æ¼”å¥ä½“é¨“ã‚’ææ¡ˆã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚

![](/images/ar-guitar-effector-avp/image_arguitar.jpg =500x)
*AR Guitar Effectorã®ã‚¤ãƒ¡ãƒ¼ã‚¸*

å…·ä½“çš„ãªä»•çµ„ã¿ã¨ã—ã¦ã¯ã€ç©ºä¸­ã«æµ®ã‹ã¶ARã®ã‚¨ãƒ•ã‚§ã‚¯ã‚¿ãƒ¼ã‚¹ã‚¤ãƒƒãƒã«å‘ã‹ã£ã¦ã‚®ã‚¿ãƒ¼ã®å…ˆç«¯ã‹ã‚‰ãƒ¬ã‚¤ã‚’é£›ã°ã™ã¨ã€ã‚®ã‚¿ãƒ¼ã®éŸ³ã«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒã‹ã‹ã‚Šã¾ã™ã€‚è‰²ã€…ãªã‚¹ã‚¤ãƒƒãƒã«ã‚®ã‚¿ãƒ¼ã‚’å‘ã‘ãªãŒã‚‰æ¼”å¥ã™ã‚‹ã“ã¨ã§ã€å¤šæ§˜ã«å¤‰åŒ–ã™ã‚‹éŸ³ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚

[æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç¬¬1å¼¾](https://zenn.dev/ekito_station/articles/ar-guitar-effector-intro)ã¨ã—ã¦æ˜¨å¹´2024å¹´æœ«ã«ã€Meta Quest 3ã‚’ä½¿ç”¨ã—ãŸAR Guitar Effectorã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…ã«ã¤ã„ã¦è¨˜äº‹ã«ã¾ã¨ã‚ã¾ã—ãŸã€‚ã‚·ã‚¹ãƒ†ãƒ ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®è¨˜äº‹ã‚’ã”è¦§ãã ã•ã„ã€‚

https://zenn.dev/ekito_station/articles/ar-guitar-effector-intro

## 1.2 Apple Vision Pro ver.

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç¬¬2å¼¾ã¨ãªã‚‹ä»Šå›ã¯ã€Apple Vision Proã‚’ä½¿ç”¨ã—ãŸAR Guitar Effectorã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

![](/images/ar-guitar-effector-avp/thumbnail.jpg =500x)
*AR Guitar Effector ã€Apple Vision Pro ver.ã€‘*

### 1.2.1 Object Trackingæ©Ÿèƒ½

ã‚·ã‚¹ãƒ†ãƒ ã«ä½¿ç”¨ã™ã‚‹HMDã‚’Meta Quest 3ã‹ã‚‰Apple Vision Proã«å¤‰æ›´ã—ãŸã“ã¨ã«ã‚ˆã£ã¦ç”Ÿã˜ã‚‹å¤§ããªé•ã„ã¯ã€ã‚®ã‚¿ãƒ¼ã®å…ˆç«¯ã®ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°æ‰‹æ³•ã§ã™ã€‚Meta Quest 3ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã‚®ã‚¿ãƒ¼ã®ãƒ˜ãƒƒãƒ‰ã«Quest 3ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’å–ã‚Šä»˜ã‘ã¦ã„ã¾ã—ãŸãŒã€Apple Vision Proã«ã¯å…¬å¼ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãã“ã§ã€ä»£ã‚ã‚Šã«ä½¿ç”¨ã—ãŸæ©Ÿèƒ½ã¯[Object Tracking](https://developer.apple.com/documentation/visionos/implementing-object-tracking-in-your-visionos-app/)ã§ã™ã€‚

https://developer.apple.com/documentation/visionos/implementing-object-tracking-in-your-visionos-app/

Object Trackingã¯ã€Apple Vision ProãŒå®Ÿç©ºé–“ä¸Šã®ç‰¹å®šã®ç‰©ç†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’èªè­˜ã™ã‚‹ã¨ã€ãã®ç‰©ç†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½ç½®ã‚„æ–¹å‘ã«ãƒãƒ¼ãƒãƒ£ãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿½å¾“ã•ã›ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚ã“ã®æ©Ÿèƒ½ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€Apple Vision ProãŒã‚®ã‚¿ãƒ¼ã®ãƒ˜ãƒƒãƒ‰ã‚’èªè­˜ã™ã‚‹ã¨ã€ãã®ä½ç½®ã‚’èµ·ç‚¹ã¨ã—ã¦ã‚®ã‚¿ãƒ¼ã®å‘ã„ã¦ã„ã‚‹æ–¹å‘ã«ãƒ¬ã‚¤ã‚’é£›ã°ã™ä»•çµ„ã¿ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### 1.2.2 ãƒ‡ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ¡ãƒªãƒƒãƒˆ

Meta Quest 3ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨æ¯”è¼ƒã—ãŸéš›ã®Apple Vision Proãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¯ã€Object Trackingã®ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆã¤ã¾ã‚Šãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã®æ›´æ–°é »åº¦ãŒã€(è‡ªåˆ†ã®è©¦ã—ãŸé™ã‚Šã§ã¯) Quest 3ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚ˆã‚Šå°ã•ã‹ã£ãŸã“ã¨ã§ã™ (AR Foundationã®Image Trackingã‚ˆã‚Šã¯å¤§ãã‹ã£ãŸ)ã€‚

ä¸€æ–¹ã§ãƒ¡ãƒªãƒƒãƒˆã¯ã€ã‚®ã‚¿ãƒ¼è‡ªä½“ã«ä½•ã‹ã‚’å–ã‚Šä»˜ã‘ã‚‹å¿…è¦ãŒãªã„ã“ã¨ã§ã™ã€‚Meta Quest 3ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ãŒã‚®ã‚¿ãƒ¼ã‹ã‚‰å¤–ã‚ŒãŸã‚‰ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ãŒæ©Ÿèƒ½ã—ãªããªã£ã¦ã—ã¾ã„ã¾ã™ãŒã€Apple Vision Proãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ãã®å¿ƒé…ãŒã‚ã‚Šã¾ã›ã‚“ã€‚

### 1.2.3 ãã®ä»–è¿½åŠ æ©Ÿèƒ½

ä»¥ä¸Šã®ã‚ˆã†ãªApple Vision Proãªã‚‰ã§ã¯ã®å¤‰æ›´ç‚¹ã®ã»ã‹ã«ã€ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

- ã‚¨ãƒ•ã‚§ã‚¯ã‚¿ãƒ¼ã‚¹ã‚¤ãƒƒãƒã®ç¨®é¡ã‚’è¿½åŠ ã—ãŸ
- ã‚¨ãƒ•ã‚§ã‚¯ã‚¿ãƒ¼ã‚¹ã‚¤ãƒƒãƒã‚’æ‰‹ã§æ´ã‚“ã§ç§»å‹•ã§ãã‚‹ã‚ˆã†ã«ã—ãŸ

ä»Šå›ã‚¨ãƒ•ã‚§ã‚¯ã‚¿ãƒ¼ã‚¹ã‚¤ãƒƒãƒã‚’3ç¨®é¡ (Distortion, Redux, Volume Swells) ç”¨æ„ã—ã€ãã‚Œãã‚Œã®ä½ç½®ã‚’æ‰‹ã§æ´ã‚“ã§å‹•ã‹ã—ã¦èª¿æ•´ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚ãã®ãŸã‚ã€ã‚¨ãƒ•ã‚§ã‚¯ã‚¿ãƒ¼ã‚¹ã‚¤ãƒƒãƒã‚’è¿‘ãã«ä¸¦ã¹ã¦ã€ãã‚Œã‚‰ã‚’ç‹™ã£ã¦ãƒ¬ã‚¤ã‚’é£›ã°ã™ã“ã¨ã§ã€åŒæ™‚ã«è¤‡æ•°ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ã‹ã‘ã‚‹ã“ã¨ã‚‚å¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚å®Ÿéš›ã®æ“ä½œã®æ§˜å­ã¯ã€ä»¥ä¸‹ã®å‹•ç”»ã‚’ã”è¦§ãã ã•ã„ã€‚

https://www.youtube.com/watch?v=IuJFRhzgsK8&t=28s

# 2 å®Ÿè£…

## 2.1 ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“åƒ

ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ã‚®ã‚¿ãƒ¼ã®å…ˆç«¯ã‹ã‚‰é£›ã°ã•ã‚ŒãŸãƒ¬ã‚¤ãŒã‚¨ãƒ•ã‚§ã‚¯ã‚¿ãƒ¼ã‚¹ã‚¤ãƒƒãƒã«å½“ãŸã£ãŸã‚Šå¤–ã‚ŒãŸã‚Šã™ã‚‹ã¨ã€Apple Vision Proã‹ã‚‰PCã«OSCãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚å—ä¿¡ã—ãŸOSCãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«åŸºã¥ã„ã¦PCä¸Šã®Ableton Liveã§ã‚®ã‚¿ãƒ¼éŸ³ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒåˆ¶å¾¡ã•ã‚Œã¾ã™ã€‚

![](/images/ar-guitar-effector-avp/system_config.png =500x)
*ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³*

## 2.2 ä½¿ç”¨ã‚½ãƒ•ãƒˆãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

ä½¿ç”¨ã‚½ãƒ•ãƒˆãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ã€‚PCã¯M1æ­è¼‰MacBook Proã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚

- Xcode (Version 16.2)
    - Reality Composer Pro
    - Create ML
    - [OSCKit](https://github.com/orchetect/OSCKit)
- Ableton Live (Suite 12.1.10)
    - Max for Live

ä»¥ä¸‹ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€Xcodeã§ã®å®Ÿè£…ã«ã¤ã„ã¦è§£èª¬ã—ã¦ã„ãã¾ã™ã€‚Ableton Liveã§ã®å®Ÿè£…ã«ã¤ã„ã¦ã¯ã€[Meta Quest 3ãƒãƒ¼ã‚¸ãƒ§ãƒ³](https://zenn.dev/ekito_station/articles/ar-guitar-effector-intro)ã¨ã»ã¼å¤‰ã‚ã‚‰ãªã„ã®ã§ã€ãã¡ã‚‰ã®è§£èª¬è¨˜äº‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

https://zenn.dev/ekito_station/articles/ar-guitar-effector-intro

## 2.3 Xcodeã§ã®å®Ÿè£…ã®è©³ç´°

### 2.3.1 ã‚®ã‚¿ãƒ¼ã®ãƒ˜ãƒƒãƒ‰ã®3Dãƒ¢ãƒ‡ãƒ«ä½œæˆ

ã¾ãšã€Object Trackingæ©Ÿèƒ½ã‚’ä½¿ã£ã¦ã€Apple Vision Proã®ã‚«ãƒ¡ãƒ©ãŒã‚®ã‚¿ãƒ¼ã®ãƒ˜ãƒƒãƒ‰ã‚’èªè­˜ã—ãŸã‚‰ãã®ä½ç½®ã«ã‚¢ãƒ³ã‚«ãƒ¼ãŒé…ç½®ã•ã‚Œã‚‹å‡¦ç†ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

#### 2.3.1.1 ã‚®ã‚¿ãƒ¼ã®ãƒ˜ãƒƒãƒ‰ã‚’3Dã‚¹ã‚­ãƒ£ãƒ³

[Object Capture](https://developer.apple.com/documentation/realitykit/realitykit-object-capture/)ãŒçµ„ã¿è¾¼ã¾ã‚ŒãŸiOSã‚¢ãƒ—ãƒªã‚’ä½¿ç”¨ã—ã¦ã€ã‚®ã‚¿ãƒ¼ã®ãƒ˜ãƒƒãƒ‰ã‚’3Dã‚¹ã‚­ãƒ£ãƒ³ã—ã¦3Dãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¾ã™ (Object Captureã¨ã¯ã€ãƒ•ã‚©ãƒˆã‚°ãƒ©ãƒ¡ãƒˆãƒªã‚’ä½¿ç”¨ã—ã¦3Dãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã§ãã‚‹APIã§ã™)ã€‚ç§ã¯ã€ã€Œ[KIRI Engine:3D Scanner & LiDAR](https://apps.apple.com/jp/app/kiri-engine-3d-scanner-lidar/id1577127142)ã€ã¨ã„ã†ã‚¢ãƒ—ãƒªã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚

![](/images/ar-guitar-effector-avp/scanned_data.jpg =300x)
*ã‚®ã‚¿ãƒ¼ã®ãƒ˜ãƒƒãƒ‰ã®3Dãƒ¢ãƒ‡ãƒ«*

:::message
3Dã‚¹ã‚­ãƒ£ãƒ³ã—ãŸã‚®ã‚¿ãƒ¼ã®ãƒ˜ãƒƒãƒ‰ã®ã‚µã‚¤ã‚ºã¯ã€ãŠã‚ˆã (å¹…) 10cm Ã— (é«˜ã•) 20cm Ã— (å¥¥è¡Œã) 2cmã§ã—ãŸã€‚

ä¸€æ–¹ã€ã‚®ã‚¿ãƒ¼ã®ãƒ˜ãƒƒãƒ‰ã«åŠ ãˆã¦ãƒãƒƒã‚¯ã‚’å«ã‚ãŸ3Dãƒ¢ãƒ‡ãƒ«ã‚‚ä½œæˆã—ã¦ã¿ã¾ã—ãŸãŒã€ã“ã®ãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ãŸå ´åˆã€Object TrackingãŒã†ã¾ãæ©Ÿèƒ½ã—ã¾ã›ã‚“ã§ã—ãŸã€‚ã‚®ã‚¿ãƒ¼ã®ãƒ˜ãƒƒãƒ‰ + ãƒãƒƒã‚¯ã®ã‚µã‚¤ã‚ºã¯ã€ãŠã‚ˆã (å¹…) 10cm Ã— **(é«˜ã•) 60cm** Ã— (å¥¥è¡Œã) 2cmã§ã—ãŸã€‚

3Dãƒ¢ãƒ‡ãƒ«ã®ã‚µã‚¤ã‚ºãŒå¤§ãããªã‚‹ã¨ã€ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ç²¾åº¦ãŒä½ä¸‹ã™ã‚‹ã‚ˆã†ã§ã™ã€‚
:::

#### 2.3.1.2 Create MLã§ãƒ¬ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”Ÿæˆ

Create MLã¨ã„ã†Xcodeå†…ã®ã‚¢ãƒ—ãƒªã§æ©Ÿæ¢°å­¦ç¿’ã‚’è¡Œã†ã“ã¨ã§ã€3Dãƒ¢ãƒ‡ãƒ«ã‹ã‚‰ãƒ¬ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚ã“ã®ãƒ¬ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€å¾Œã§Reality Composer Proã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚

Create MLã¯ã€Xcodeã‹ã‚‰`Xcode > Open Developer Tool > Create ML`ã§é–‹ãã“ã¨ãŒã§ãã¾ã™ã€‚

![](/images/ar-guitar-effector-avp/createml.png)
*Create MLã®ç”»é¢*

ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã«3Dãƒ¢ãƒ‡ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ã‹ã‚‰ã€Viewing anglesã‚’è¨­å®šã—ã¾ã™ã€‚Viewing Anglesã¨ã¯ç‰©ç†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã©ã®è§’åº¦ã‹ã‚‰èªè­˜ã—å¾—ã‚‹ã‹ã®è¨­å®šã§ã€All Angles (å…¨è§’åº¦ã‹ã‚‰)ã€Upright (ä¸‹æ–¹ä»¥å¤–ã‹ã‚‰)ã€Front (ä¸‹æ–¹ãƒ»èƒŒé¢ä»¥å¤–ã‹ã‚‰) ã®ä¸­ã‹ã‚‰é¸æŠã§ãã¾ã™ã€‚ç§ã®å ´åˆã¯ã€ã‚®ã‚¿ãƒ¼ã®ãƒ˜ãƒƒãƒ‰ã¯è‰²ã€…ãªè§’åº¦ã‹ã‚‰è¦‹ãˆå¾—ã‚‹ã®ã§ã€All Anglesã‚’é¸æŠã—ã¾ã—ãŸã€‚

ãã—ã¦ã€Trainãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ©Ÿæ¢°å­¦ç¿’ã‚’é–‹å§‹ã•ã›ã¾ã™ã€‚ç§ã®å ´åˆã¯ã€å®Œäº†ã¾ã§ã«22æ™‚é–“åŠã»ã©ã‹ã‹ã‚Šã¾ã—ãŸã€‚

æ©Ÿæ¢°å­¦ç¿’ãŒå®Œäº†ã—ãŸã‚‰ã€Outputã‚¿ãƒ–ã«ç§»å‹•ã—Getãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€ãƒ¬ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¿å­˜ã—ã¾ã™ã€‚

### 2.3.2 Object Trackingã®ã‚¢ãƒ³ã‚«ãƒ¼ä½œæˆ

#### 2.3.2.1 Xcodeãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ

ã“ã“ã§ã€Xcodeã§æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ã€`visionOS > Application > App`ã‚’é¸æŠã—ã¾ã™ã€‚

![](/images/ar-guitar-effector-avp/xcode.png)
*Xcodeã®ç”»é¢*

ç¶šã„ã¦ã€Reality Composer Proã‚’é–‹ãã¾ã™ã€‚Xcodeç”»é¢å·¦ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚¿ãƒ¼ã‚¨ãƒªã‚¢ã‹ã‚‰`Packages > RealityKitContent > Package`ã‚’é–‹ãã€ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆå³ä¸Šã®Open in Reality Composer Proãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

#### 2.3.2.2 Reality Composer Proã§ã‚¢ãƒ³ã‚«ãƒ¼è¨­å®š

![](/images/ar-guitar-effector-avp/rcp.png)
*Reailty Composer Proã®ç”»é¢*

`Immersive.usda`ã¨ã„ã†ã‚·ãƒ¼ãƒ³ã‚’é–‹ãã€ã‚·ãƒ¼ãƒ³å†…ã«ç©ºã®Transformã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’é…ç½®ã—ã¾ã™ (ã‚·ãƒ¼ãƒ³ã«å…ƒã‹ã‚‰ã‚ã‚‹Sphere_Leftã‚„Sphere_Rightã¯å¿…è¦ãªã‘ã‚Œã°å‰Šé™¤)ã€‚ç§ã®å ´åˆã¯ã€ã“ã®Transformã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®åç§°ã‚’`GuitarAnchor`ã«å¤‰æ›´ã—ã¾ã—ãŸã€‚ã“ã®Transformã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’é¸æŠã—ã€ç”»é¢å³ã®ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼ã§Anchoringã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¿½åŠ ã—ã¾ã™ã€‚

Anchoringã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ãŠã„ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å„é …ç›®ã‚’è¨­å®šã—ã¾ã™ã€‚

- Target: `Object`
- Anchor Object: å…ˆã»ã©ç”Ÿæˆã—ãŸãƒ¬ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

ã“ã‚Œã§ã€ãƒ¬ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨åŒã˜è¦‹ãŸç›®ã®ç‰©ç†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒApple Vision Proã®ã‚«ãƒ¡ãƒ©ã«èªè­˜ã•ã‚ŒãŸã‚‰ã€ãã®ä½ç½®ã«ã‚¢ãƒ³ã‚«ãƒ¼ãŒé…ç½®ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

:::message
Object Trackingã¯ImmersiveSpaceã§ã—ã‹æ©Ÿèƒ½ã—ãªã„ãŸã‚ã€`Immersive`ã‚·ãƒ¼ãƒ³ã‚’ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
:::

### 2.3.3 ã‚¨ãƒ•ã‚§ã‚¯ã‚¿ãƒ¼ã‚¹ã‚¤ãƒƒãƒä½œæˆ

ä»Šåº¦ã¯ã€ã‚¨ãƒ•ã‚§ã‚¯ã‚¿ãƒ¼ã‚¹ã‚¤ãƒƒãƒã¨ãªã‚‹ã‚­ãƒ¥ãƒ¼ãƒ–ã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚ã‚·ãƒ¼ãƒ³å†…ã«Primitive Shapeã®Cubeã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’é…ç½®ã—ã¦ã„ãã€ãã‚Œãã‚Œé©åˆ‡ãªåç§°ã«å¤‰æ›´ã—ã¾ã™ (ç§ã®å ´åˆã¯`DistortionSwitch`ã€`ReduxSwitch`ã€`ViolinSwitch`)ã€‚

ã¾ãŸã€å„ã‚­ãƒ¥ãƒ¼ãƒ–ã«ä»¥ä¸‹ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¿½åŠ ã—ã¾ã™ã€‚

- Input Targetã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ (æ‰‹ã§æ´ã‚“ã§ç§»å‹•ã§ãã‚‹ã‚ˆã†ã«)
- Collisionã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ (æ‰‹ã§æ´ã‚“ã§ç§»å‹•ã§ãã‚‹ã‚ˆã†ã«ã€ã‹ã¤ãƒ¬ã‚¤ãŒå½“ãŸã£ãŸã“ã¨ã‚’æ¤œçŸ¥ã§ãã‚‹ã‚ˆã†ã«)

#### 2.3.3.1 Shader Graph

å„ã‚­ãƒ¥ãƒ¼ãƒ–ã®è¦‹ãŸç›®ã‚’èª¿æ•´ã™ã‚‹ãŸã‚ã«ã€Reality Composer Proã®Shader Graphã‚’æ´»ç”¨ã—ã¾ã—ãŸã€‚

ãŸã¨ãˆã°ã€`ReduxSwitch`ã«é©ç”¨ã—ãŸã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ã¯ã€Shader Graphã§ä»¥ä¸‹ã®ã‚ˆã†ã«æ§‹ç¯‰ã—ã¾ã—ãŸã€‚Reduxã¨ã¯Ableton Liveã«å†…è”µã•ã‚Œã¦ã„ã‚‹ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¸€ç¨®ã§ã€ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªä¿¡å·ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆãƒ»ãƒ“ãƒƒãƒˆè§£åƒåº¦ã‚’ä¸‹ã’ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’è¦–è¦šçš„ã«è¡¨ç¾ã™ã‚‹ãŸã‚ã«ã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®è§£åƒåº¦ã‚’è½ã¨ã™ã€ã™ãªã‚ã¡ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ¢ã‚¶ã‚¤ã‚¯èª¿ã«ã™ã‚‹ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ã‚’ä½œæˆã—ã¾ã—ãŸã€‚

![](/images/ar-guitar-effector-avp/shader_graph.png)
*Shader Graphã®ç”»é¢*

#### 2.3.3.2 ã‚­ãƒ¥ãƒ¼ãƒ–ã‚’æ‰‹ã§æ´ã‚“ã§ç§»å‹•ã§ãã‚‹ã‚ˆã†ã«

å„ã‚­ãƒ¥ãƒ¼ãƒ–ã‚’æ‰‹ã§æ´ã‚“ã§ç§»å‹•ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã«ã€Xcodeã«æˆ»ã‚Šã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç·¨é›†ã—ã¾ã™ã€‚

`ImmersiveView.swift`ã‚’é–‹ãã¨ã€å…ˆã»ã©Reality Composer Proã§ç·¨é›†ã—ãŸ`Immersive`ã‚·ãƒ¼ãƒ³ã‚’RealityViewå†…ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨ã—ã¦èª­ã¿è¾¼ã‚€å‡¦ç†ãŒå…ƒã‹ã‚‰æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚ã“ã“ã«ã€ãƒ‰ãƒ©ãƒƒã‚°ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ã‚’å®šç¾©ã—ã¦RealityViewã«é©ç”¨ã™ã‚‹å‡¦ç†ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```swift:ImmersiveView.swift
import SwiftUI
import RealityKit
import RealityKitContent

struct ImmersiveView: View {

    var body: some View {
        RealityView { content in
            // Immersiveã‚·ãƒ¼ãƒ³ã‚’RealityViewã«èª­ã¿è¾¼ã‚€
            if let immersiveContentEntity = try? await Entity(named: "Immersive", in: realityKitContentBundle) {
                content.add(immersiveContentEntity)
            }
        }
        .gesture(dragGesture) // ãƒ‰ãƒ©ãƒƒã‚°ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ã‚’RealityViewã«é©ç”¨
    }
    // ãƒ‰ãƒ©ãƒƒã‚°ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ã‚’å®šç¾©
    var dragGesture: some Gesture {
        DragGesture()
            .targetedToAnyEntity()
            .onChanged { value in
                value.entity.position = value.convert(value.location3D, from: .local, to: value.entity.parent!)
            }
    }
}
```

ã“ã‚Œã«ã‚ˆã£ã¦ã€è¦ªæŒ‡ã¨äººå·®ã—æŒ‡ã§ã‚­ãƒ¥ãƒ¼ãƒ–ã‚’ãƒ”ãƒ³ãƒã—ã¦ä¿æŒã—ãŸçŠ¶æ…‹ã§æ‰‹ã‚’å‹•ã‹ã™ã“ã¨ã§ã€ã‚­ãƒ¥ãƒ¼ãƒ–ã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ç§»å‹•ã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

### 2.3.4 ã‚¢ãƒ³ã‚«ãƒ¼ã®ä½ç½®ã‹ã‚‰ãƒ¬ã‚¤ã‚­ãƒ£ã‚¹ãƒˆ

ã‚¢ãƒ³ã‚«ãƒ¼ã®ä½ç½®ã‹ã‚‰ãƒ¬ã‚¤ã‚’é£›ã°ã™å‡¦ç†ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

#### 2.3.4.1 ã‚¢ãƒ³ã‚«ãƒ¼ã®ä½ç½®ã‚„æ–¹å‘ã‚’å–å¾—

ã‚¢ãƒ³ã‚«ãƒ¼ãŒé…ç½®ã•ã‚ŒãŸéš›ã«ãã®ã‚¢ãƒ³ã‚«ãƒ¼ã«è¿½å¾“ã•ã›ã‚‹ãŸã‚ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ (ä»¥ä¸‹ã€RayOrigin) ã‚’ã€Reality Composer Proã®`Immersive`ã‚·ãƒ¼ãƒ³å†…ã«é…ç½®ã—ã¦ãŠãã¾ã™ã€‚ç§ã®å ´åˆã¯ã€`RayOrigin`ã¨ã„ã†åç§°ã§Cubeã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’é…ç½®ã—ã¾ã—ãŸã€‚

![](/images/ar-guitar-effector-avp/ray_origin.png)
*RayOrigin*

ã‚¢ãƒ³ã‚«ãƒ¼ã®Transformã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã¯ã€ã‚ã‚‰ã‹ã˜ã‚Xcodeã®`ImmersiveView.swift`ã«ãŠã„ã¦ã€[SpatialTrackingSession.Configuration](https://developer.apple.com/documentation/realitykit/spatialtrackingsession/configuration)ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ãã®ã†ãˆã§ã€[transformMatrix](https://developer.apple.com/documentation/realitykit/hastransform/transformmatrix(relativeto:))ã‚’ç”¨ã„ã¦ã‚¢ãƒ³ã‚«ãƒ¼ã®Transformã‚’å–å¾—ã—ã¾ã™ã€‚ãã—ã¦ã€[setTransformMatrix](https://developer.apple.com/documentation/realitykit/hastransform/settransformmatrix(_:relativeto:))ã‚’ç”¨ã„ã¦RayOriginã®Transformã‚’ã‚¢ãƒ³ã‚«ãƒ¼ã®Transformã¨æƒãˆã¾ã™ã€‚ã“ã®å‡¦ç†ã‚’æ¯ãƒ•ãƒ¬ãƒ¼ãƒ ç¹°ã‚Šè¿”ã™ã“ã¨ã§ã€RayOriginãŒã‚¢ãƒ³ã‚«ãƒ¼ã«è¿½å¾“ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ (èª¬æ˜ã«ç›´æ¥é–¢ä¿‚ã™ã‚‹ç®‡æ‰€ã®ã¿æŠœç²‹ã—ã¦ã„ã¾ã™)ã€‚

```swift:ImmersiveView.swift
struct ImmersiveView: View {
    var body: some View {
        RealityView { content in
            if let immersiveContentEntity = try? await Entity(named: "Immersive", in: realityKitContentBundle) {
                content.add(immersiveContentEntity)

                // SpatialTrackingSession.Configurationã‚’å®Ÿè¡Œã™ã‚‹
                let session = SpatialTrackingSession()
                let configuration = SpatialTrackingSession.Configuration(tracking: [.object, .world])
                let _ = await session.run(configuration)

                // Updateã‚¤ãƒ™ãƒ³ãƒˆã‚’subscribeã™ã‚‹
                _ = content.subscribe(to: SceneEvents.Update.self) { event in
                    updateRaycast() // ã“ã®é–¢æ•°ãŒæ¯ãƒ•ãƒ¬ãƒ¼ãƒ å®Ÿè¡Œã•ã‚Œã‚‹
                }
            }
        }
    }
    
    func updateRaycast() {
        // ã‚¢ãƒ³ã‚«ãƒ¼ã®Transformã‚’å–å¾—ã™ã‚‹
        let anchorTransform = guitarAnchor?.transformMatrix(relativeTo: nil)
        // guitarAnchorã¯Reality Composer Proã®Immersiveã‚·ãƒ¼ãƒ³å†…ã®GuitarAnchorã‚’å‚ç…§ã™ã‚‹å¤‰æ•°
        
        // RayOriginã®Transformã‚’ã‚¢ãƒ³ã‚«ãƒ¼ã®Transformã¨æƒãˆã‚‹
        rayOrigin?.setTransformMatrix(anchorTransform ?? matrix_identity_float4x4, relativeTo: nil)
        // rayOriginã¯Reality Composer Proã®Immersiveã‚·ãƒ¼ãƒ³å†…ã®RayOriginã‚’å‚ç…§ã™ã‚‹å¤‰æ•°
    }
}
```

:::message alert
æœ€åˆã¯ã€RayOriginã‚’ä»‹ã•ãšã«ç›´æ¥ã‚¢ãƒ³ã‚«ãƒ¼ã®translation (ä½ç½®) ã‚„rotation (å‘ã) ã‚’ç”¨ã„ã¦ãƒ¬ã‚¤ã‚­ãƒ£ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã‚ˆã†ã¨ã—ã¾ã—ãŸãŒã€ä¸Šæ‰‹ãã„ã‹ãšå››è‹¦å…«è‹¦ã—ã¾ã—ãŸã€‚

ã‚¢ãƒ³ã‚«ãƒ¼ã¯ã‚·ãƒ¼ãƒ³å†…ã®ä»–ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®åº§æ¨™ç³» (ãƒ¯ãƒ¼ãƒ«ãƒ‰åº§æ¨™ç³») ã¨ã¯ç•°ãªã‚‹åº§æ¨™ç³»ã«ã‚ã‚‹ã‚ˆã†ãªã®ã§ã€[transformMatrix](https://developer.apple.com/documentation/realitykit/hastransform/transformmatrix(relativeto:))ã‚’ç”¨ã„ã¦ã‚¢ãƒ³ã‚«ãƒ¼ã®Transformã‚’ãƒ¯ãƒ¼ãƒ«ãƒ‰åº§æ¨™ç³»ã«ãŠã‘ã‚‹Transformã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚ã¾ãŸã€[transformMatrix](https://developer.apple.com/documentation/realitykit/hastransform/transformmatrix(relativeto:))ã‚’ç”¨ã„ã¦å–å¾—ã—ãŸã‚¢ãƒ³ã‚«ãƒ¼ã®Transformã‹ã‚‰ã¯ã€ã‚¢ãƒ³ã‚«ãƒ¼ã®translationã‚„rotationã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚

ãã®ãŸã‚ä¸Šè¨˜ã®ã‚ˆã†ã«ã€RayOriginã‚’ä»‹ã™ã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æ¡ç”¨ã—ã¾ã—ãŸã€‚
:::

#### 2.3.4.2 ãƒ¬ã‚¤ã‚­ãƒ£ã‚¹ãƒˆã®å®Ÿè¡Œ

[raycast](https://developer.apple.com/documentation/realitykit/scene/raycast(origin:direction:length:query:mask:relativeto:))ã‚’ç”¨ã„ã¦ã€RayOriginã®ä½ç½®ã‹ã‚‰RayOriginã®ä¸Šæ–¹ã«å‘ã‹ã£ã¦ãƒ¬ã‚¤ã‚­ãƒ£ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```swift:ImmersiveView.swift
// RayOriginã®ä½ç½®ã‚’å–å¾—
let originPosition = rayOrigin?.convert(transform: Transform(), to: nil).translation
// RayOriginã®ä¸Šæ–¹ã‚’å–å¾—
let upDirection = rayOrigin?.convert(direction: SIMD3<Float>(0, 1, 0), to: nil)

// ãƒ¬ã‚¤ã‚­ãƒ£ã‚¹ãƒˆã®å®Ÿè¡Œ
guard let results = rayOrigin?.scene?.raycast(origin: originPosition ?? SIMD3<Float>(0, 0, 0), direction: upDirection ?? SIMD3<Float>(0, 1, 0), length: 10) else {
    print("Error: results is nil.")
    return
}
```

[raycast](https://developer.apple.com/documentation/realitykit/scene/raycast(origin:direction:length:query:mask:relativeto:))ã«ã‚ˆã£ã¦é£›ã°ã•ã‚Œã‚‹ãƒ¬ã‚¤è‡ªä½“ã¯ã‚·ãƒ¼ãƒ³å†…ã«è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚ãã“ã§ã€ãƒ¬ã‚¤ãŒé£›ã‚“ã§ã„ã‚‹æ–¹å‘ãŒè¦–è¦šçš„ã«åˆ†ã‹ã‚Šã‚„ã™ã„ã‚ˆã†ã«ã€Reality Composer Proã«ãŠã„ã¦ã€ã‚¢ãƒ³ã‚«ãƒ¼ã®å­ã¨ã—ã¦ç©ºã®Transformã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’é…ç½®ã—ã€ãã“ã«Particle Emitterã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ã€ã‚¢ãƒ³ã‚«ãƒ¼ã®ä½ç½®ã‹ã‚‰ãƒ¬ã‚¤ãŒé£›ã¶ã®ã¨åŒã˜æ–¹å‘ã«ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã‚’é£›ã°ã—ã¾ã™ã€‚

![](/images/ar-guitar-effector-avp/particle.png)
*ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã‚’é£›ã°ã™*

### 2.3.5 ãƒ¬ã‚¤ãŒã‚­ãƒ¥ãƒ¼ãƒ–ã«å½“ãŸã£ãŸã‚‰OSCãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡

æœ€å¾Œã«ã€ãƒ¬ã‚¤ãŒã‚­ãƒ¥ãƒ¼ãƒ–ã«å½“ãŸã£ãŸã‚‰OSCãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

#### 2.3.5.1 OSCKitã®è¿½åŠ 

OSCãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ã€[OSCKit](https://github.com/orchetect/OSCKit)ã‚’Xcodeã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«è¿½åŠ ã—ã¾ã™ã€‚

`File > Add Package Dependencies...`ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è¡¨ç¤ºã•ã‚ŒãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®æ¤œç´¢ãƒãƒ¼ã«ã€`https://github.com/orchetect/OSCKit`ã¨å…¥åŠ›ã—ã¾ã™ã€‚OSCKitãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰é¸æŠã—ã¦Add Packageãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

![](/images/ar-guitar-effector-avp/osckit1.png)
*OSCKitã®è¿½åŠ  â‘ *

æ¬¡ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®Add to Targetã®åˆ—ã§ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¨åŒã˜åç§°ã®Target (ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå+Testsã€ã§ã¯ãªã„ã»ã†) ã‚’é¸æŠã—ã¦Add Packageãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

![](/images/ar-guitar-effector-avp/osckit2.png)
*OSCKitã®è¿½åŠ  â‘¡*

#### 2.3.5.2 OSCãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€ä¿¡

`ImmersiveView.swift`ã«ãŠã„ã¦ã€å…ˆã«è¿°ã¹ãŸã‚ˆã†ã«ãƒ¬ã‚¤ã‚­ãƒ£ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€ãã®çµæœã‚’å–ã‚Šå‡ºã—ã¾ã™ã€‚ãƒ¬ã‚¤ãŒå½“ãŸã£ãŸã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®åç§°ãŒã‚­ãƒ¥ãƒ¼ãƒ–ã®åç§°ã¨ä¸€è‡´ã™ã‚‹å ´åˆã€OSCãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ (èª¬æ˜ã«ç›´æ¥é–¢ä¿‚ã™ã‚‹ç®‡æ‰€ã®ã¿æŠœç²‹ã—ã¦ã„ã¾ã™)ã€‚ã“ã®ä¾‹ã§ã¯ã€ãƒ¬ã‚¤ãŒDistortionSwitchã¨å½“ãŸã£ãŸå ´åˆã€OSCã‚¢ãƒ‰ãƒ¬ã‚¹`/arguitar`ã«å€¤`1`ã‚’é€ä¿¡ã—ã¦ã„ã¾ã™ã€‚

```swift:ImmersiveView.swift
import OSCKit

struct ImmersiveView: View {
    private let OSC_IP_ADDRESS = "000.000.000.000" // Ableton Liveã‚’èµ·å‹•ã•ã›ã¦ã„ã‚‹PCã®IPã‚¢ãƒ‰ãƒ¬ã‚¹
    private let OSC_PORT  = 0000 // ãƒãƒ¼ãƒˆç•ªå·
    private let oscClient  = OSCClient()
    
    func updateRaycast() {
        (ä¸­ç•¥)
        // ãƒ¬ã‚¤ã‚­ãƒ£ã‚¹ãƒˆã®å®Ÿè¡Œ
        guard let results = rayOrigin?.scene?.raycast(origin: originPosition ?? SIMD3<Float>(0, 0, 0), direction: upDirection ?? SIMD3<Float>(0, 1, 0), length: 10) else {
            print("Error: results is nil.")
            return
        }

        // ãƒ¬ã‚¤ã‚­ãƒ£ã‚¹ãƒˆçµæœã®å‡¦ç†
        for result in results {
            if (result.entity.name == "DistortionSwitch") {
                // ãƒ¬ã‚¤ã¨å½“ãŸã£ãŸã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®åç§°ãŒ"DistortionSwitch"ã ã£ãŸã‚‰OSCãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
                let msg = OSCMessage("/arguitar", values: [1])
                do {
                    try oscClient.send(msg, to: OSC_IP_ADDRESS, port: UInt16(OSC_PORT))
                } catch {
                    print("Failed to send OSC message: \(error.localizedDescription)")
                }
            }
        }
    }
}
```

# ãŠã‚ã‚Šã«

ä»¥ä¸Šã€"AR Guitar Effectorã€Apple Vision Pro ver.ã€‘"ã®é–‹ç™ºè¨˜éŒ²ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚[ç¬¬16å›VRãƒ•ã‚§ã‚¹](https://peatix.com/event/4292335?lang=ja-jp)ã§ã¯æ¥å ´è€…ã®çš†ã•ã‚“ã«ä½“é¨“ã—ã¦ã‚‚ã‚‰ã£ãŸã‚Šç§ãŒæ¼”å¥ã—ã¦ã„ã‚‹æ§˜å­ã‚’è¦‹ã¦ã‚‚ã‚‰ã£ãŸã‚Šã—ã¦ã€é¢ç™½ã„ã¨ã„ã†å£°ã‚’ãŸãã•ã‚“ã„ãŸã ã‘ã¦å¬‰ã—ã‹ã£ãŸã§ã™ã€‚ã¾ãŸã€ç¬¬16å›Vã‚¢ã‚«ã‚ªãƒ¼ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã§ã¯ã‚ã‚ŠãŒãŸã„ã“ã¨ã«ã€æŠ€è¡“çš„è¦³ç‚¹ã§é«˜ã„è©•ä¾¡ã ã£ãŸä½œå“ã«è´ˆã‚‰ã‚Œã‚‹ã€ŒæŠ€è¡“è³ã€ã¨ã€å—è¬›ç”Ÿé–“ã§é«˜ã„è©•ä¾¡ã ã£ãŸä½œå“ã«è´ˆã‚‰ã‚Œã‚‹ã€ŒStudentè³ã€ã‚’å—è³ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸï¼

![](/images/ar-guitar-effector-avp/vr_academy.jpg =500x)
*ç¬¬16å›Vã‚¢ã‚«ã‚ªãƒ¼ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã«ã¦æŠ€è¡“è³å—è³*

ä»Šå¾Œã‚‚æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ç™ºå±•ã•ã›ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚ãã—ã¦ã€AR Guitar Effectorã‚’ä½¿ã£ãŸãƒ©ã‚¤ãƒ–ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®å®Ÿè·µã¨ã—ã¦ã€2025/3/25ã«BuzzFront Yokohamaã§é–‹å‚¬ã•ã‚Œã‚‹ã€Œ[Iwaken Lab. Performers Fest](https://lu.ma/9o0wuz9n?locale=ja&tk=dSOAms)ã€ã«å‡ºæ¼”ã—ã¾ã™ï¼ã€ŒImmersive Live with AR Guitarã€ã¨ã„ã†æ¼”ç›®ã§ã€MRæŠ€è¡“ã‚’ä½¿ã£ãŸæ²¡å…¥å‹æ¼”å‡ºã¨çµ„ã¿åˆã‚ã›ãŸã‚®ã‚¿ãƒ¼ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æŠ«éœ²ã™ã‚‹äºˆå®šã§ã™ã€‚XRãªã©ã®ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã‚’æ´»ç”¨ã—ãŸéŸ³æ¥½è¡¨ç¾ãƒ»ãƒ©ã‚¤ãƒ–æ¼”å‡ºã«ã”èˆˆå‘³ãŒã‚ã‚‹æ–¹ã¯ãœã²ãŠè¶Šã—ãã ã•ã„ï¼

https://lu.ma/9o0wuz9n?locale=ja&tk=dSOAms

![](/images/ar-guitar-effector-avp/performers_fest.jpg)

## å‚è€ƒè¨˜äº‹

- https://1planet.co.jp/tech-blog/applevisionpro-oneplanet-visionos2-object-tracking

https://1planet.co.jp/tech-blog/applevisionpro-oneplanet-visionos2-object-tracking

- https://1planet.co.jp/tech-blog/applevisionpro-realityview-model-drag

https://1planet.co.jp/tech-blog/applevisionpro-realityview-model-drag

- https://1planet.co.jp/tech-blog/applevisionpro-oneplanet-24062601-spatial-tracking

https://1planet.co.jp/tech-blog/applevisionpro-oneplanet-24062601-spatial-tracking

- https://zenn.dev/meson_tech_blog/articles/visionos-collision-detection?redirected=1

https://zenn.dev/meson_tech_blog/articles/visionos-collision-detection?redirected=1


